<!DOCTYPE html>
<html lang="en">

<head data-no-analytics="false">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta charset="utf-8">
    <link href="./images/icon_128.png" rel="shortcut icon">
     <!--  <meta content="Productivity" itemprop="applicationCategory">
    <meta content="Sejda" itemprop="applicationSuite">
    <meta content="2010-10-01" itemprop="datePublished">
    <meta content="http://www.sejda.com/images/icon_128.png" itemprop="image">
    <meta content="website" property="og:type">
    <meta content="http://www.sejda.com/" property="og:url">
    <meta content="http://www.sejda.com/images/twitter-card.jpg" property="og:image">
    <meta content="Sejda.com - helps with your PDF tasks" property="og:site_name">
    <meta content="summary_large_image" name="twitter:card">
    <meta content="@SejdaPDF" name="twitter:site">
    <meta content="@SejdaPDF" name="twitter:creator">
    <meta content="http://www.sejda.com/images/twitter-card.jpg" name="twitter:image">
    <meta content="1762774073964212" property="fb:app_id">
    <link rel="alternate" hreflang="en" href="./pdf-editor">
    <link rel="alternate" hreflang="de" href="./de/pdf-editor">
    <link rel="alternate" hreflang="fr" href="./fr/pdf-editor">
    <link rel="alternate" hreflang="ro" href="./ro/pdf-editor">
    <link rel="alternate" hreflang="nl" href="./nl/pdf-editor">
    <link rel="alternate" hreflang="no" href="./no/pdf-editor">
    <link rel="alternate" hreflang="pt" href="./pt/pdf-editor">
    <link rel="alternate" hreflang="it" href="./it/pdf-editor">
    <link rel="alternate" hreflang="es" href="./es/pdf-editor">
    <link rel="alternate" hreflang="pl" href="./pl/pdf-editor">
    <link rel="alternate" hreflang="sv" href="./sv/pdf-editor">
    <link rel="alternate" hreflang="fi" href="./fi/pdf-editor">
    <link rel="alternate" hreflang="ja" href="./ja/pdf-editor">
    <link rel="alternate" hreflang="ar" href="./ar/pdf-editor">
    <link rel="canonical" href="https://www.sejda.com/pdf-editor">
     <link href="https://fonts.gstatic.com" crossorigin="" rel="preconnect">
    <link href="https://accounts.google.com" rel="preconnect">
    <link href="https://ssl.google-analytics.com" rel="preconnect">
    <link href="https://apis.google.com" rel="preconnect">
    <link href="https://content.googleapis.com" rel="preconnect">
    <link href="https://www.google.com" rel="preconnect">
    <link href="https://www.dropbox.com" rel="preconnect">
 -->
    <link href="https://use.fontawesome.com" rel="preconnect">
    <link href="./css/index.min.css" rel="stylesheet">
    <script type="text/javascript">
        var _gaq = _gaq || [];
        if (window.location.href.indexOf("localhost") != -1) {
            window['ga-disable-UA-30159698-1'] = true;
        }
        _gaq.push(['_setAccount', 'UA-30159698-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            if (document.getElementsByTagName("HEAD")[0].getAttribute('data-no-analytics') == 'true') return;
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <script>
        var Analytics = (function() {
            var _events = [];
            return {
                trackEvent: function(one, two, three, four) {
                    _events.push([one, two, three, four]);
                    if (_gaq) {
                        _gaq.push(['_trackEvent', one, two, three, four]);
                        //console.log('track event', one, two, three, four)
                    }
                },
                events: function() {
                    return _events;
                }
            }
        })();
    </script>
    <script src="js/libs.js"></script>
    <script src="js/pdfjs/FileSaver.js"></script>
    <script src="js/pdfjs/pdf.min.js"></script>
    <script>
        PDFJS.workerSrc = 'js/pdfjs/pdf.worker.js';
        //PDFJS.maxImageSize = 1024 * 1024;
        PDFJS.cMapUrl = './cmaps/';
        PDFJS.cMapPacked = true;
    </script>
    <script>
        // prevent stray occurrences of `console.log` from causing errors in IE
        (function(window) {
            var console = window.console || (window.console = {});
            console.log || (console.log = function() {});

        }(this));

        String.prototype.endsWith = function(suffix) {
            return this.indexOf(suffix, this.length - suffix.length) !== -1;
        };

        jQuery.fn.toggleDisabled = function() {
            $(this[0]).prop('disabled', function(_, val) {
                return !val;
            });
        };

        jQuery.fn.scrollHere = function(offset) {
            var $elem = $(this[0]);
            if ($elem.length == 0) {
                console.error('Cannot scrollHere, element not found', $elem);
                return;
            }

            $('html, body').animate({
                scrollTop: $elem.offset().top + (offset || 0)
            }, 500);
        };

        jQuery.fn.scrollStopped = function(callback) {
            var that = this,
                $this = $(that);
            $this.scroll(function(ev) {
                clearTimeout($this.data('scrollTimeout'));
                $this.data('scrollTimeout', setTimeout(callback.bind(that), 250, ev));
            });
        };

        jQuery.fn.clearCanvases = function() {
            $(this).find('canvas').each(function() {
                var canvas = this;
                var context = canvas.getContext('2d');
                context.clearRect(0, 0, canvas.width, canvas.height);
            })
        }

        jQuery.fn.cloneWithCanvas = function() {
            var $self = $(this)
            var $clone = $(this).clone()

            $clone.find('canvas').each(function() {
                var $this = $(this)
                var id = $this.attr('id')

                var oldCanvas = $self.find('#' + id).get(0),
                    newCanvas = this;
                var context = newCanvas.getContext('2d');

                //set dimensions
                newCanvas.width = oldCanvas.width;
                newCanvas.height = oldCanvas.height;

                //apply the old canvas to the new one
                context.drawImage(oldCanvas, 0, 0);
            })

            return $clone
        };

        jQuery.fn.isInViewport = function() {
            var el = this[0]
            var rect = el.getBoundingClientRect();

            if (rect.top == 0 && rect.bottom == 0 && rect.left == 0 && rect.right == 0) {
                // elem is hidden
                return false
            }

            var $win = $(window)

            var outsideViewport = (
                // el completely out of viewport when
                // el bottom is above the viewport top or
                // el top is below the viewport's bottom or
                // el right is less than viewport's left
                // otherwise the el is partially within viewport
                rect.bottom < 0 ||
                rect.right < 0 ||
                rect.top > $win.height() ||
                rect.left > $win.width()
            )

            return !outsideViewport

        }

        jQuery.fn.classes = function(startsWith, callback) {
            var classes = [];
            startsWith = startsWith || ''
            $.each(this, function(i, v) {
                var splitClassName = v.className.split(/\s+/);
                for (var j in splitClassName) {
                    var className = splitClassName[j];
                    if (-1 === classes.indexOf(className)) {
                        if (className.index(startsWith) == 0) {
                            classes.push(className);
                        }
                    }
                }
            });

            if ('function' === typeof callback) {
                for (var i in classes) {
                    callback(classes[i]);
                }
            }
            return classes;
        };

        jQuery.fn.shake = function() {
            this.each(function(i) {
                for (var x = 1; x <= 3; x++) {
                    $(this).animate({
                        left: -10
                    }, 10).animate({
                        left: 0
                    }, 50).animate({
                        left: 10
                    }, 10).animate({
                        left: 0
                    }, 50);
                }
            });
            return this;
        }

        jQuery.jsonPost = function(url, data, headers) {
            return $.ajax({
                    url: url,
                    data: JSON.stringify(data),
                    headers: headers,
                    method: 'POST',
                    dataType: 'json',
                    contentType: 'application/json; charset=utf-8'
                })
                // console.log("jsonpost" + data);
        }

        String.prototype.hashCode = function() {
            var hash = 0,
                i, chr, len;
            if (this.length == 0) return hash;
            for (i = 0, len = this.length; i < len; i++) {
                chr = this.charCodeAt(i);
                hash = ((hash << 5) - hash) + chr;
                hash |= 0; // Convert to 32bit integer
            }
            return hash;
        };

        String.prototype.alphanumeric = function() {
            var result = ''
            for (var i = 0; i < this.length; i++) {
                result += this.charCodeAt(i)
            }
            return result;
        }

        String.prototype.capitalize = function() {
            return this.charAt(0).toUpperCase() + this.slice(1);
        }

        var sendGaEvent = function(one, two, three) {
            if (_gaq) {
                _gaq.push(['_trackEvent', one, two, three]);
            }
        }

        var zIndexCounter = 901
        var showAlert = function(msg, type, dismissable) {
            type = type || 'danger'
            dismissable = dismissable !== false

            var hashCode = msg.hashCode()
            if ($('#alert' + hashCode).length > 0) return;

            var alert = $('<div id="alert' + hashCode + '" class="top-alert alert alert-' + type + ' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>' + msg + '</div>')
            $('body').prepend(alert)
            alert.fadeIn(200)
            if (dismissable) {
                alert.click(function() {
                    alert.alert('close')
                })
            } else {
                alert.removeClass('alert-dismissable')
                alert.find('.close').remove()
            }

            alert.css('z-index', zIndexCounter)
            zIndexCounter += 1
        }

        var showUpgradePopupIf = function(reason) {
            if (window.upgradePopupShown) return
            showUpgradePopup(reason)
        }

        var showUpgradePopup = function(reason) {
            var $popup = $('#upgrade-section');
            if ($popup.find('#' + reason + '-reason').is(':visible')) return;

            $popup.find('#' + reason + '-reason').show()
            $popup.show()

            setTimeout(function() {
                $('.task-form').find('button[type="submit"]').attr('disabled', 'disabled')
                $popup.scrollHere(-200)

                // enable the form later, so upgraded users can continue the task
                setTimeout(function() {
                    $('.task-form').find('button[type="submit"]').removeAttr('disabled')
                }, 10 * 1000)

            }, 500)

            Analytics.trackEvent('paywall', reason)
            $.cookie('upgradeReason', reason, {
                path: '/'
            })
            window.upgradePopupShown = true
        }

        String.prototype.truncateMiddle = function(strLen) {
            if (this.length <= strLen) return this;

            var separator = '...';
            var sepLen = separator.length,
                charsToShow = strLen - sepLen,
                frontChars = Math.ceil(charsToShow / 2),
                backChars = Math.floor(charsToShow / 2);

            return this.substr(0, frontChars) +
                separator +
                this.substr(this.length - backChars);
        };

        String.prototype.dropRight = function(len) {
            if (this.length <= len) return this;

            return this.substr(0, this.length - len);
        };

        var isBlank = function(s) {
            return s === undefined || s.trim().length == 0
        }
        var isNotBlank = function(s) {
            return !isBlank(s)
        }
        var isNum = function(s) {
            return isNotBlank(s.trim()) && !isNaN(s.trim())
        }
        var isStrictPositiveNum = function(s) {
            return isNum(s) && s > 0
        }

        var formValidators = {
            'page-range': function(input) {
                var f = input.split('-');
                return f.length <= 2 && isStrictPositiveNum(f[0]) && (isBlank(f[1]) || isStrictPositiveNum(f[1]))
            },
            'pages': function(input) {
                var segs = input.split(',');
                return _.all(segs, function(f) {
                    return isStrictPositiveNum(f)
                })
            },
            'page-ranges': function(input) {
                var segs = _.map(input.split(','), function(i) {
                    return i.split('-')
                });

                return _.all(segs, function(f) {
                    return f.length <= 2 && isStrictPositiveNum(f[0]) && (isBlank(f[1]) || isStrictPositiveNum(f[1]))
                })
            },
            'page-ranges-or-empty': function(input) {
                return input.trim().length == 0 || formValidators['page-ranges'](input)
            },
            'page-ranges-or-predefined': function(input) {
                return input.trim().length == 0 || input.trim() == 'even' || input.trim() == 'odd' || input.trim() == 'all' ||
                    formValidators['page-ranges'](input)
            }
        }

        var runFormValidators = function($form) {
            var result = true;
            $form.find('input[data-validator]:visible').each(function(i, input) {
                var val = $(input).val();
                var validatorName = $(input).attr('data-validator')
                var validator = formValidators[validatorName];

                if (!validator) {
                    console.log('Unknown validator', validatorName)
                    return;
                }

                var valid = validator(val);

                if (!valid) {
                    result = false;
                    $(input).addClass('has-error').tooltip({
                        html: true,
                        title: '<span class="danger">Value is invalid</span>',
                        trigger: 'manual',
                        placement: 'left'
                    }).tooltip('show')
                } else {
                    $(input).removeClass('has-error')
                }
            })

            return result;
        }

        var getQueryParameterByName = function(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        function isIe() {
            return /Edge\/|Trident\/|MSIE /.test(window.navigator.userAgent)
        }
    </script>
    <script>
        $(function() {
            $.ajaxSetup({
                cache: false
            });
        })
    </script>
    <script>
        $(function() {
            $('.get-support-btn').attr('href', 'mailto:hi@sejda.com?subject=Hello')
            $('.get-support-btn').click(function(e) {
                e.preventDefault()
                $('#contactFormModal').modal();
            })
        })
    </script>
    <script>
        $(function() {
            if (document.referrer) {
                if (document.referrer.indexOf('sejda.com/') < 0 && $.cookie('partner') == undefined) {
                    $.cookie('partner', document.referrer, {
                        expires: 365,
                        path: '/'
                    });
                }
            }
        })
    </script>
    <title>Online PDF Editor</title>
    <!-- <meta name="description" content="Online PDF Editor. Edit PDF files online free. Fill PDF forms. Sign PDF online. Add text, links, images and shapes. Edit existing PDF text. Annotate PDF. Online, no installation or registration required. It's free, quick and easy to use.">
    <meta property="og:title" content="Sejda.com - Online PDF Editor">
    <meta property="og:description" content="Edit PDF files online free. Fill PDF forms. Sign PDF online. Add text, links, im<!-- ages and shapes. Edit existing PDF text. Annotate PDF. Online, no installation or registration required. It's free, quick and easy to use.">
      <meta name="twitter:title" content="Sejda.com - Online PDF Editor">
    <meta name="twitter:description" content="Edit PDF files online free. Fill PDF forms. Sign PDF online. Add text, links, images and shapes. Edit existing PDF text. Annotate PDF. Online, no installation or registration required. It's free, quick and easy to use.">
    --><script>
        var rangyAutoInitialize = false;
        rangy.config.autoInitialize = false;
    </script>
    <link href="css/editor.css" rel="stylesheet" type="text/css" />
    <style>
        
    </style>
</head>

<body data-ipcountry="CA" data-pro-user="false" data-max-file-size="500" data-expired-user="false">
 <!--   <div class="left_pane" style="float:left;width:50%; border: 1px solid red;">-->
        <section id="body-wrap">
            <div style="display: none" class="alert alert-meh alert-dismissible centered" id="cookieCompliance">
                <button aria-label="Close" data-dismiss="alert" class="close" type="button"><span aria-hidden="true">×</span></button> We use cookies to deliver and analyse the usage of our services. By using our website, you agree to our <a href="terms#privacy"
                    target="_blank">use of cookies</a> and to our <a href="terms" target="_blank">terms and conditions</a>.
            </div>
            <div style="display: none" class="alert alert-meh alert-dismissible centered" id="termsCompliance">
                <button aria-label="Close" data-dismiss="alert" class="close" type="button"><span aria-hidden="true">×</span></button> We've updated our <a target="_blank" href="terms">terms and conditions</a>. Please take a moment and review them. By
                using our website, you agree to our updated <a href="terms" target="_blank">terms and conditions</a>.
            </div>
            <script>
                $(function() {
                    var $cookieCompliance = $('#cookieCompliance');
                    var $termsCompliance = $('#termsCompliance');
                    $cookieCompliance.on('closed.bs.alert', function() {
                        $.cookie('cookieCompliance', 'true', {
                            path: '/',
                            expires: 365
                        });
                        $.cookie('termsCompliance', 'v3', {
                            path: '/',
                            expires: 365
                        });
                    }).click(function() {
                        $(this).alert('close')
                    });

                    $termsCompliance.on('closed.bs.alert', function() {
                        $.cookie('termsCompliance', 'v3', {
                            path: '/',
                            expires: 365
                        });
                    }).click(function() {
                        $(this).alert('close')
                    });

                    if (!$.cookie('cookieCompliance')) {
                        // new user
                        $cookieCompliance.show()
                    } else {
                        // existing user
                        if ($.cookie('termsCompliance') != 'v3') {
                            $termsCompliance.show()
                        }
                    }
                })
            </script>
            <script>
                $(function() {
                    function keyFor($in) {
                        var page = window.location.pathname;
                        var fieldName = $in.attr('name')

                        return encodeURIComponent('settings.' + page + '.' + fieldName)
                    }

                    var $remembered = $('input.remembered')
                    $remembered.each(function() {
                        var $this = $(this)
                        var key = keyFor($this)
                        if (localStorage && localStorage.getItem(key)) {
                            var value = localStorage.getItem(key)
                            $this.val(value)
                            if ($this.is(':checkbox')) {
                                $this.prop('checked', value == 'true');
                            }
                        }
                    })

                    $remembered.on('change', function() {
                        var $this = $(this)
                        var key = keyFor($this)
                        if (localStorage) {
                            var value = $this.val()
                            if ($this.is(':checkbox')) value = $this.is(':checked')
                            localStorage.setItem(key, value)
                        }
                    })
                })
            </script>
            <script>
                /*
                 * Natural Sort algorithm for Javascript - Version 0.8.1 - Released under MIT license
                 * Author: Jim Palmer (based on chunking idea from Dave Koelle)
                 */
                function naturalSort(a, b) {
                    var re = /(^([+\-]?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?(?=\D|\s|$))|^0x[\da-fA-F]+$|\d+)/g,
                        sre = /^\s+|\s+$/g, // trim pre-post whitespace
                        snre = /\s+/g, // normalize all whitespace to single ' ' character
                        dre = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,
                        hre = /^0x[0-9a-f]+$/i,
                        ore = /^0/,
                        i = function(s) {
                            return (naturalSort.insensitive && ('' + s).toLowerCase() || '' + s).replace(sre, '');
                        },
                        // convert all to strings strip whitespace
                        x = i(a),
                        y = i(b),
                        // chunk/tokenize
                        xN = x.replace(re, '\0$1\0').replace(/\0$/, '').replace(/^\0/, '').split('\0'),
                        yN = y.replace(re, '\0$1\0').replace(/\0$/, '').replace(/^\0/, '').split('\0'),
                        // numeric, hex or date detection
                        xD = parseInt(x.match(hre), 16) || (xN.length !== 1 && Date.parse(x)),
                        yD = parseInt(y.match(hre), 16) || xD && y.match(dre) && Date.parse(y) || null,
                        normChunk = function(s, l) {
                            // normalize spaces; find floats not starting with '0', string or 0 if not defined (Clint Priest)
                            return (!s.match(ore) || l == 1) && parseFloat(s) || s.replace(snre, ' ').replace(sre, '') || 0;
                        },
                        oFxNcL, oFyNcL;
                    // first try and sort Hex codes or Dates
                    if (yD) {
                        if (xD < yD) {
                            return -1;
                        } else if (xD > yD) {
                            return 1;
                        }
                    }
                    // natural sorting through split numeric strings and default strings
                    for (var cLoc = 0, xNl = xN.length, yNl = yN.length, numS = Math.max(xNl, yNl); cLoc < numS; cLoc++) {
                        oFxNcL = normChunk(xN[cLoc] || '', xNl);
                        oFyNcL = normChunk(yN[cLoc] || '', yNl);
                        // handle numeric vs string comparison - number < string - (Kyle Adams)
                        if (isNaN(oFxNcL) !== isNaN(oFyNcL)) {
                            return isNaN(oFxNcL) ? 1 : -1;
                        }
                        // if unicode use locale comparison
                        if (/[^\x00-\x80]/.test(oFxNcL + oFyNcL) && oFxNcL.localeCompare) {
                            var comp = oFxNcL.localeCompare(oFyNcL);
                            return comp / Math.abs(comp);
                        }
                        if (oFxNcL < oFyNcL) {
                            return -1;
                        } else if (oFxNcL > oFyNcL) {
                            return 1;
                        }
                    }
                }
            </script>
            <script>
                function unicodeEscape(str) {
                    return str.replace(/[\s\S]/g, function(character) {
                        var escape = character.charCodeAt().toString(16),
                            longhand = escape.length > 2;
                        return '\\' + (longhand ? 'u' : 'x') + ('0000' + escape).slice(longhand ? -4 : -2);
                    });
                }

                function resizeImage($img, newWidth, newHeight) {
                    var naturalWidth = $img.get(0).naturalWidth
                    var naturalHeight = $img.get(0).naturalHeight
                        //console.log('Asked to resize image to', newWidth, newHeight, 'from', naturalWidth, naturalHeight)

                    if (naturalWidth <= newWidth || naturalHeight <= newHeight) {
                        //console.log('Image smaller than requested dimensions, doing nothing')
                        return $img.attr('src')
                    }

                    var canvas = document.getElementById("image-resize-canvas");
                    canvas.width = newWidth;
                    canvas.height = newHeight;

                    var ctx = canvas.getContext("2d");
                    ctx.drawImage($img.get(0), 0, 0, newWidth, newHeight);

                    return canvas.toDataURL();
                }

                // Returns a function, that, as long as it continues to be invoked, will not
                // be triggered. The function will be called after it stops being called for
                // N milliseconds. If `immediate` is passed, trigger the function on the
                // leading edge, instead of the trailing.
                function debounce(func, wait, immediate) {
                    var timeout;
                    return function() {
                        var context = this,
                            args = arguments;
                        var later = function() {
                            timeout = null;
                            if (!immediate) func.apply(context, args);
                        };
                        var callNow = immediate && !timeout;
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                        if (callNow) func.apply(context, args);
                    };
                };
            </script>
            <div style="display: none" class="alert alert-warning" id="unsupportedBrowser">
                You seem to be using an old, unsupported browser. Please upgrade to the latest version of <a target="_blank" href="http://getfirefox.com">Firefox</a>, <a target="_blank" href="http://www.google.com/chrome/">Chrome</a>, Safari or Internet
                Explorer (11+)
            </div>
          
            <div class="container-fluid">
                <header>
                    <div class="container">
                        <div class="pull-left">
                            <a href="javascript://" class="btn btn-default btn-secondary btn-xs more-tasks">More tasks <i class="fa fa-angle-down"></i></a>
                            <div style="display: none" class="row nav-sidebar more-tasks-nav">
                                <ul class="first">
                                    <li class="header">
                                        <strong>Split PDF</strong>
                                    </li>
                                    <li>
                                        <a href="extract-pdf-pages" class="popular">Extract PDF Pages</a>
                                    </li>
                                    <li>
                                        <a href="split-pdf" class="popular">Split PDF by pages</a>
                                    </li>
                                    <li>
                                        <a href="split-pdf-by-outline">Split PDF by bookmarks</a>
                                    </li>
                                    <li>
                                        <a href="split-pdf-down-the-middle">Split PDF in half</a>
                                    </li>
                                    <li>
                                        <a href="split-pdf-by-size">Split PDF by size</a>
                                    </li>
                                    <li>
                                        <a href="split-pdf-by-text">Split PDF by text</a>
                                    </li>
                                </ul>
                                <ul>
                                    <li class="header"><strong>Merge PDF</strong></li>
                                    <li>
                                        <a href="alternate-mix-pdf">Alternate &amp; Mix PDF</a>
                                    </li>
                                    <li>
                                        <a href="visually-combine-reorder-pdf">Visual Combine &amp; Reorder PDF</a>
                                    </li>
                                    <li>
                                        <a href="merge-pdf" class="popular">Merge PDF</a>
                                    </li>
                                    <li class="empty">

                                    </li>
                                    <li class="header"><strong>Office &amp; PDF</strong></li>
                                    <li>
                                        <a href="pdf-to-word">PDF to Word</a>
                                    </li>
                                    <li>
                                        <a href="word-to-pdf">Word to PDF</a>
                                    </li>
                                    <li>
                                        <a href="pdf-to-excel">PDF to Excel</a>
                                    </li>
                                </ul>
                                <ul style="margin-right: 20px;">
                                    <li class="header">
                                        <strong>Edit &amp; Sign</strong>
                                    </li>
                                    <li>
                                        <a href="pdf-editor" class="popular">PDF Editor</a>
                                    </li>
                                    <li class="empty">

                                    </li>
                                    <li>
                                        <a href="crop-pdf" class="popular">Crop PDF</a>
                                    </li>
                                    <li>
                                        <a href="delete-pdf-pages">Delete PDF Pages</a>
                                    </li>
                                    <li>
                                        <a href="header-footer-pdf">Header &amp; Footer PDF</a>
                                    </li>
                                    <li>
                                        <a href="bates-numbering-pdf">Bates Numbering PDF</a>
                                    </li>
                                    <li>
                                        <a href="rotate-pdf-pages">Rotate PDF</a>
                                    </li>
                                    <li>
                                        <a href="repair-pdf">Repair PDF<span class="label label-success">New</span></a>
                                    </li>
                                    <li>
                                        <a href="resize-pdf">Resize PDF<span class="label label-success">New</span></a>
                                    </li>
                                    <li>
                                        <a href="watermark-pdf">Watermark PDF<span class="label label-success">New</span></a>
                                    </li>
                                </ul>
                                <ul style="margin-right: 20px;">
                                    <li class="header">
                                        <strong>Compress &amp; Convert</strong>
                                    </li>
                                    <li>
                                        <a href="compress-pdf" class="popular">Compress PDF</a>
                                    </li>
                                    <li>
                                        <a href="pdf-to-jpg">PDF to JPG</a>
                                    </li>
                                    <li>
                                        <a href="jpg-to-pdf">JPG to PDF</a>
                                    </li>
                                    <li>
                                        <a href="encrypt-pdf">Protect PDF</a>
                                    </li>
                                    <li>
                                        <a href="decrypt-pdf">Unprotect PDF</a>
                                    </li>
                                    <li>
                                        <a href="extract-text-from-pdf">Extract Text PDF</a>
                                    </li>
                                    <li>
                                        <a href="n-up-pdf">N-up PDF</a>
                                    </li>
                                    <li>
                                        <a href="html-to-pdf">HTML to PDF<span class="label label-success">New</span></a>
                                    </li>
                                    <li>
                                        <a href="grayscale-pdf">Grayscale PDF<span class="label label-success">New</span></a>
                                    </li>
                                </ul>
                                <div style="padding: 20px; margin-top: 20px;"><a style="color: #259066;" class="get-support-btn suggest-task-btn" href="javascript://">Can't find your task? Suggest a new one</a></div>
                            </div>
                        </div>
                        <script>
                            $(function() {
                                var hideTimeout, showTimeout;
                                var $navSidebar = $('.nav-sidebar.more-tasks-nav');
                                var $moreTasksBtn = $('.more-tasks');

                                function showNavSidebar() {
                                    showTimeout = setTimeout(function() {
                                        $moreTasksBtn.addClass('hover');
                                        $navSidebar.fadeIn()
                                    }, 300);

                                    clearTimeout(hideTimeout)
                                }

                                function hideNavSidebar() {
                                    hideTimeout = setTimeout(function() {
                                        $moreTasksBtn.removeClass('hover');
                                        $navSidebar.fadeOut();
                                    }, 100)

                                    clearTimeout(showTimeout)
                                }

                                $('.suggest-task-btn').click(hideNavSidebar);
                                $moreTasksBtn.mouseover(showNavSidebar);
                                $moreTasksBtn.mouseout(hideNavSidebar);
                                $navSidebar.mouseover(showNavSidebar);
                                $navSidebar.mouseout(hideNavSidebar);
                            })
                        </script>
                        <div data-pro-user="false" id="user-header" class="">
                            <div class="loggedout">
                                <a href="login" class="btn btn-default btn-secondary btn-xs">Log in</a>
                            </div>
                            <div class="loggedin"></div>
                            <script>
                                $(function() {
                                    $('#logoutBtn').click(function(e) {
                                        e.preventDefault();
                                        $.removeCookie('User_Ticket', {
                                            path: '/',
                                            domain: 'sejda.com'
                                        });
                                        $.removeCookie('User_Ticket', {
                                            path: '/'
                                        });
                                        try {
                                            GoogleApis.load(function() {
                                                gapi.load('auth2', function() {
                                                    gapi.auth2.init({
                                                        client_id: '8721525582-fbt24du8pl38r1ht2ihu9q9vl815o5t8.apps.googleusercontent.com'
                                                    }).then(function() {
                                                        var auth2 = gapi.auth2.getAuthInstance();
                                                        auth2.signOut().then(function() {
                                                            window.location.reload();
                                                        });
                                                    });

                                                });
                                            });

                                        } catch (e) {
                                            console.log('Error signing out of Google', e);
                                            window.location.reload();
                                        }
                                    })
                                })
                            </script>
                        </div>
                    </div>
                </header>
            </div>
            <section data-multiple-files="false" data-task="edit" id="task-content">
                <div style="font-family: Stalemate; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Over the Rainbow'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Caveat'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Cedarville Cursive'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Dancing Script'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Give You Glory'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Kristi'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Mr De Haviland'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Norican'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Reenie Beanie'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Satisfy'; font-size: 1px;" class="fontPreload">.</div>
                <div style="font-family: 'Zeyada'; font-size: 1px;" class="fontPreload">.</div>
                <div class="container centered" style="width:50%;">
                    <div class="row">
                        <!--  <h1>Online PDF Editor<span class="beta">BETA</span></h1>
                        <h2>Edit PDF files online free. Fill PDF forms. Sign PDF online</h2>
                        <h2>Add text, links, images and shapes. Edit existing PDF text. Annotate PDF</h2>
                      -->
                        <script>
                            window.lastTextEditSettings = {
                                size: 10,
                                color: '#000',
                                font: 'Helvetica,serif'
                            };

                            window.lastShapeEditSettings = {
                                'border-width': 2,
                                'background-color': 'rgba(0, 0, 0, 0)',
                                'border-color': '#FF0000'
                            };
                        </script>
                        <div style="display: none" class="text-editable-menu edit-menu" id="text-editable-menu">
                            <div aria-label="..." role="group" class="btn-group">
                                <button class="btn btn-default font-bold-opts"><i class="fa fa-bold"></i></button>
                                <button class="btn btn-default font-italic-opts"><i class="fa fa-italic"></i></button>
                                <div role="group" class="btn-group">
                                    <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-text-height"></i><span class="caret"></span></button>
                                    <ul class="dropdown-menu font-size-opts">
                                        <li><input name="fontSize" value="10" max="100" min="1" type="range"></li>
                                    </ul>
                                </div>
                                <div role="group" class="btn-group">
                                    <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" class="btn btn-default dropdown-toggle" type="button">Font Family<span class="caret"></span></button>
                                    <ul class="dropdown-menu font-family-opts">
                                        <li><a data-font="Helvetica,sans-serif" class="helvetica" href="javascript://">Helvetica</a></li>
                                        <li><a data-font="'Times New Roman',serif" class="times-new-roman" href="javascript://">Times New Roman</a></li>
                                        <li><a data-font="'Courier New',monospace" class="courier" href="javascript://">Courier</a></li>
                                    </ul>
                                </div>
                                <div role="group" class="btn-group">
                                    <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" class="btn btn-default dropdown-toggle" type="button">Color<span class="caret"></span></button>
                                    <div class="dropdown-menu color-opts">
                                        <div class="color-swatch-col">
                                            <a style="background-color: #01579B" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #0277BD" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #0288D1" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #039BE5" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #03A9F4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #29B6F6" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4FC3F7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #81D4FA" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #B3E5FC" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E1F5FE" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #1B5E20" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #2E7D32" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #388E3C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #43A047" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4CAF50" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #66BB6A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #81C784" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #A5D6A7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C8E6C9" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C8E6C9" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #F57F17" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F9A825" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FBC02D" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FDD835" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEB3B" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEE58" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF176" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF59D" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF9C4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFFDE7" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #B71C1C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C62828" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #D32F2F" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E53935" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F44336" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EF5350" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E57373" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EF9A9A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFCDD2" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEBEE" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #4A148C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #6A1B9A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #7B1FA2" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #8E24AA" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #9C27B0" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #AB47BC" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BA68C8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #CE93D8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E1BEE7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F3E5F5" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #3E2723" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4E342E" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #5D4037" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #6D4C41" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #795548" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #8D6E63" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #A1887F" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BCAAA4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #D7CCC8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EFEBE9" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #212121" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #424242" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #616161" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #757575" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #9E9E9E" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BDBDBD" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E0E0E0" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EEEEEE" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F5F5F5" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FAFAFA" class="color-swatch" href="javascript://"></a>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-default delete-opts"><i class="fa fa-trash-o"></i></button>
                            </div>
                        </div><!-- text edit tools-->
                        <div style="display: none" class="shape-editable-menu edit-menu" id="shape-editable-menu">
                            <div aria-label="..." role="group" class="btn-group">
                                <div role="group" class="btn-group">
                                    <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-minus"></i><span class="caret"></span></button>
                                    <ul class="dropdown-menu border-size-opts">
                                        <li>
                                            <a href="javascript://">
                                                <div style="height: 1px; background-color: #000; width: 100%; margin: 5px 0;"></div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript://">
                                                <div style="height: 2px; background-color: #000; width: 100%; margin: 5px 0;"></div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript://">
                                                <div style="height: 3px; background-color: #000; width: 100%; margin: 5px 0;"></div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript://">
                                                <div style="height: 4px; background-color: #000; width: 100%; margin: 5px 0;"></div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript://">
                                                <div style="height: 6px; background-color: #000; width: 100%; margin: 5px 0;"></div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript://">
                                                <div style="height: 8px; background-color: #000; width: 100%; margin: 5px 0;"></div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript://">
                                                <div style="height: 12px; background-color: #000; width: 100%; margin: 5px 0;"></div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript://">
                                                <div style="height: 18px; background-color: #000; width: 100%; margin: 5px 0;"></div>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div role="group" class="btn-group">
                                    <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-square-o"></i><span class="caret"></span></button>
                                    <div class="dropdown-menu border-color-opts">
                                        <div class="color-swatch-col">
                                            <a style="background-color: #01579B" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #0277BD" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #0288D1" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #039BE5" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #03A9F4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #29B6F6" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4FC3F7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #81D4FA" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #B3E5FC" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E1F5FE" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #1B5E20" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #2E7D32" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #388E3C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #43A047" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4CAF50" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #66BB6A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #81C784" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #A5D6A7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C8E6C9" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C8E6C9" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #F57F17" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F9A825" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FBC02D" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FDD835" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEB3B" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEE58" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF176" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF59D" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF9C4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFFDE7" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #B71C1C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C62828" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #D32F2F" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E53935" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F44336" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EF5350" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E57373" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EF9A9A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFCDD2" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEBEE" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #4A148C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #6A1B9A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #7B1FA2" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #8E24AA" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #9C27B0" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #AB47BC" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BA68C8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #CE93D8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E1BEE7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F3E5F5" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #3E2723" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4E342E" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #5D4037" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #6D4C41" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #795548" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #8D6E63" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #A1887F" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BCAAA4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #D7CCC8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EFEBE9" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #212121" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #424242" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #616161" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #757575" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #9E9E9E" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BDBDBD" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E0E0E0" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EEEEEE" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFFFFF; border-color: #CCC;" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: transparent; border-color: #CCC; position: relative;" class="color-swatch" href="javascript://">
                                                <div class="diagonal-red-line"></div>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div role="group" class="btn-group">
                                    <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-square"></i><span class="caret"></span></button>
                                    <div class="dropdown-menu background-color-opts">
                                        <div class="color-swatch-col">
                                            <a style="background-color: #01579B" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #0277BD" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #0288D1" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #039BE5" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #03A9F4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #29B6F6" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4FC3F7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #81D4FA" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #B3E5FC" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E1F5FE" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #1B5E20" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #2E7D32" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #388E3C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #43A047" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4CAF50" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #66BB6A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #81C784" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #A5D6A7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C8E6C9" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C8E6C9" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #F57F17" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F9A825" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FBC02D" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FDD835" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEB3B" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEE58" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF176" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF59D" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFF9C4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFFDE7" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #B71C1C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #C62828" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #D32F2F" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E53935" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F44336" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EF5350" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E57373" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EF9A9A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFCDD2" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFEBEE" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #4A148C" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #6A1B9A" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #7B1FA2" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #8E24AA" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #9C27B0" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #AB47BC" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BA68C8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #CE93D8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E1BEE7" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #F3E5F5" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #3E2723" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #4E342E" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #5D4037" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #6D4C41" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #795548" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #8D6E63" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #A1887F" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BCAAA4" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #D7CCC8" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EFEBE9" class="color-swatch" href="javascript://"></a>
                                        </div>
                                        <div class="color-swatch-col">
                                            <a style="background-color: #212121" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #424242" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #616161" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #757575" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #9E9E9E" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #BDBDBD" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #E0E0E0" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #EEEEEE" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: #FFFFFF; border-color: #CCC;" class="color-swatch" href="javascript://"></a>
                                            <a style="background-color: transparent; border-color: #CCC; position: relative;" class="color-swatch" href="javascript://">
                                                <div class="diagonal-red-line"></div>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-default delete-opts"><i class="fa fa-trash-o"></i></button>
                            </div>
                        </div><!-- shape edit tools -->
                        <div style="display: none" class="link-editable-menu edit-menu" id="link-editable-menu">
                            <div aria-label="..." role="group" class="btn-group">
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-link"></i> </span>
                                        <input autocomplete="off" placeholder="https://example.com/" class="form-control" type="text">
                                    </div>
                                </div>
                                <button class="btn btn-default delete-opts"><i class="fa fa-trash-o"></i></button>
                            </div>
                        </div><!-- link edit tools -->
                        <!-- -->
                        <div style="display: none" class="target-editable-menu edit-menu" id="target-editable-menu">
                            <div aria-label="..." role="group" class="btn-group">
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-link"></i> </span>
                                        <input autocomplete="off" id="pdfvalue" placeholder="export.pdf" class="form-control" type="text">
                                    </div>
                                </div>
                                <button class="btn btn-default delete-opts"><i class="fa fa-trash-o"></i></button>
                            </div>
                        </div>
                     
                        <div style="display: none" class="image-editable-menu edit-menu" id="image-editable-menu">
                            <div aria-label="..." role="group" class="btn-group">
                                <button class="btn btn-default rotate-opts"><i class="fa fa-rotate-right"></i></button>
                                <button class="btn btn-default delete-opts"><i class="fa fa-trash-o"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <section>
                    <div id="upload-progress">
                        <div style="width: 0%" class="bar"></div>
                    </div>
                    <div style="display:none" id="expiredSubscriptionWarning" class="alert alert-warning"></div>
                    <div class="container-fluid container-upgrade-section">
                        <section style="display: none;" id="upgrade-section">
                            <h2>
                                <span id="files-per-hour-reason" style="display: none;">You reached your free limit of 30 files per hour.<br>Please upgrade to continue processing this task.</span>
                                <span id="tasks-per-hour-reason" style="display: none;">You reached your free limit of 3 tasks per hour.<br>Please upgrade to continue processing this task.</span>
                                <span id="free-file-size-reason" style="display: none;">You reached your free limit of 100MB per file.<br>Please upgrade to continue processing this task.</span>
                                <span id="free-image-file-size-reason" style="display: none;">You reached your free limit of 5MB per image file.<br>Please upgrade to continue processing this task.</span>
                                <span id="free-multiple-files-reason" style="display: none;">Free users are limited to a single file per task.<br>Please upgrade to continue processing multiple files at once.</span>
                            </h2>
                            <a target="_blank" href="upgrade" class="btn btn-default upgrade-btn">Upgrade</a>
                        </section>
                    </div>
                    <div class="centered step1" style="width:100%; text-align:center;">
                        <div class="row" style="width:100%;">
                            <div class="drop-files-zone">
                                <div class="drop-files-zone-hint">Drag &amp; drop files anywhere on the page to upload</div>
                                <div class="btn-group upload-btn-group main" style="opacity: 0.3">
                                    <span class="btn btn-lg fileinput-button"><i class="fa fa-file-pdf-o"></i><span style="display: none" class="singular">Upload PDF file</span>
                                    <span class="plural">Upload PDF files</span>
                                    <form data-filetypes="pdf" action="" enctype="multipart/form-data" method="post" id="fileUploadForm">
                                        <input name="key" type="hidden">
                                        <input name="AWSAccessKeyId" type="hidden">
                                        <input name="acl" type="hidden">
                                        <input name="success_action_redirect" type="hidden">
                                        <input name="policy" type="hidden">
                                        <input name="signature" type="hidden">
                                        <input name="Content-type" type="hidden">
                                        <input name="x-amz-storage-class" type="hidden">
                                        <input data-url="" accept=".pdf" title="Upload" multiple="multiple" data-scope="task-file" name="file" type="file" data-allows-drop="true" class="fileupload">
                                    </form>
                                    </span>
                                    <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" class="btn btn-lg dropdown-toggle" type="button"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
                                    <ul class="dropdown-menu">
                                        <li><a class="drpbox-chooser" href="javascript://"><i class="fa fa-dropbox icon"></i> Dropbox</a></li>
                                        <li>
                                            <a class="gdrive-chooser" href="javascript://"> Google Drive</a>
                                        </li>
                                    </ul>
                                </div>
                                <section>
                                    <p class="hint">
                                        Files stay private. Automatically deleted after 5 hours.<br> Free service for documents up to <span id="freePagesLimit">200</span> pages or 50 Mb.</p>
                                    <p class="desktop-promo">
                                        <a href="/desktop">Rather work offline? Try Sejda Desktop</a>
                                    </p>
                                </section>
                            </div>
                        </div>
                    </div>
                    <div style="display: none" class="modal file-pwd-prompt" id="filePwdPrompt">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span></button>
                                    <h4 class="modal-title">Password for <span class="file-name">file.pdf</span></h4>
                                </div>
                                <div class="modal-body">
                                    <label style="display: none; color: #a94442;" class="danger">Incorrect password</label>
                                    <input class="file-pwd form-control input-lg" name="filePwd" type="text">
                                </div>
                                <div class="modal-footer">
                                    <button data-dismiss="modal" class="btn btn-light btn-xs" type="button">Cancel</button>
                                    <button class="btn btn-primary btn-xs" type="button">Continue</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <script>
                        var $fileUploadForm = $('#fileUploadForm');
                        var filetypes = $fileUploadForm.attr('data-filetypes').split(',');

                        $fileUploadForm.find('.fileupload').attr('accept', _.map(filetypes, function(ext) {
                            return '.' + ext
                        }));

                        function acceptsFileType(ext) {
                            return filetypes.indexOf(ext) >= 0
                        }

                        function changeCaption($elem, replacement) {
                            var caption = $elem.text().replace('PDF', replacement)
                            $elem.text(caption);
                        }

                        if (acceptsFileType('docx')) {
                            $('.upload-btn-group').find('.fa-file-pdf-o').removeClass('fa-file-pdf-o').addClass('fa-file-word-o')

                            $('.upload-btn-group').find('.singular, .plural').each(function() {
                                changeCaption($(this), 'DOCx')
                            })
                        }

                        if (acceptsFileType('jpeg')) {
                            $('.upload-btn-group').find('.fa-file-pdf-o').removeClass('fa-file-pdf-o').addClass('fa-picture-o')

                            $('.upload-btn-group').find('.singular, .plural').each(function() {
                                changeCaption($(this), 'image');
                            });
                        }

                        /*var PdfFilesPwd = (function() {

                            return {
                                prompt: function(file, callback, cancelCallback) {
                                    var $prompt = $('#filePwdPrompt').clone().removeAttr('id')

                                    $prompt.find('.file-name').text(file.name.truncateMiddle(30));
                                    var $btn = $prompt.find('.btn-primary');
                                    $btn.click(function() {
                                        var pwd = $prompt.find('input').val();
                                        callback(pwd);

                                        function submitPwdIfFileWasUploaded() {

                                            if (!file.id) {
                                                return setTimeout(submitPwdIfFileWasUploaded, 300);
                                            }

                                            $.jsonPost('/api/files/' + file.id + '/password', {
                                                    password: pwd
                                                })
                                                .fail(function() {
                                                    showAlert('Could not save document password', 'danger');
                                                })
                                        }

                                        submitPwdIfFileWasUploaded();
                                        $prompt.modal('hide');
                                    });

                                    $prompt.find('.file-pwd').keypress(function(e) {
                                        if (e.which == 13) $prompt.find('.btn-primary').click();
                                    });

                                    $prompt.find('[data-dismiss="modal"]').click(function() {
                                        if (cancelCallback) cancelCallback()
                                    })

                                    $prompt.find('input').keyup(function() {
                                        $prompt.find('.danger').hide()
                                    })

                                    $prompt.on('shown.bs.modal', function() {
                                        $prompt.find('input').focus()
                                    })

                                    $prompt.on('shown.bs.modal', function() {
                                        $prompt.find('input').focus()
                                    })

                                    $prompt.modal('show')
                                    $prompt.shake()
                                }
                            }
                        })()*/
                    </script><!-- file upload form -->
                    <script>
                        var FileUploadExpirationWarning = (function() {
                            var files = [];

                            function now() {
                                return (new Date().getTime());
                            }

                            function add(file) {
                                if (file.expires_in) {
                                    // calculate absolute expiration date
                                    file.expirationDate = now() + file.expires_in * 1000;
                                    //console.log('File', file.name, 'expires in', file.expires_in, 'seconds', file.expirationDate);
                                } else {
                                    //console.error('No file expiration found', file)
                                }
                                files.push(file);
                            };

                            // check every 10 seconds if there are files about to expire in the next 20 minutes.
                            // if yes, warn.
                            var interval = setInterval(function() {
                                var fileThatExpires = _.find(files, function(f) {
                                    var soon = now() + 20 * 60 * 1000;
                                    return f.expirationDate < soon;
                                });

                                if (fileThatExpires) {
                                    alert('Some files will expire in the next 20 minutes. Process them soon to avoid losing any unsaved work.');

                                    // we want to warn only once
                                    clearInterval(interval);
                                }
                            }, 10 * 1000);

                            return {
                                add: add
                            };
                        })();
                    </script>
                    <script>
                        var PdfFilesCache = (function() {
                            var pdfFilesCache = {}

                            this.put = function(file, pdf) {
                                pdfFilesCache[file.counter] = {
                                    pdf: pdf,
                                    file: file
                                }
                            }

                            this.get = function(file) {
                                return pdfFilesCache[file.counter || file]
                            }

                            return this;
                        })()

                        var PdfFiles = (function() {

                            return {
                                getDocument: function(file, successCallback, failureCallback) {
                                    var oldProgress = 0;
                                    failureCallback = failureCallback || function() {}

                                    var progressCallback = function(progress) {
                                        progress.total = progress.total || file.bytes;
                                        var percentLoaded = Math.floor(progress.loaded / progress.total * 100);

                                        var $progress = $('.doc-loading').find('.progress-radial')
                                        $progress.find('.overlay').text(percentLoaded + '%')

                                        var newProgress = Math.floor(percentLoaded / 5) * 5

                                        if (oldProgress < newProgress) {
                                            $progress.removeClass('progress-' + oldProgress).removeClass('progress-100').addClass('progress-' + newProgress);
                                            oldProgress = newProgress;
                                        }
                                    };

                                    function failure(reason) {
                                        //console.log(reason)
                                        showAlert('Could not open file "' + encodeURIComponent(file.name).truncateMiddle(15) + '"')
                                        failureCallback(reason)
                                    }

                                    function callback(pdf) {
                                        if (pdf.numPages == 0) failure('No pages');
                                        else {
                                            PdfFilesCache.put(file, pdf)
                                            successCallback(pdf)
                                        }
                                    }

                                    function passwordCallback(updateCallback, reason) {
                                        PdfFilesPwd.prompt(file, function(pwd) {
                                            updateCallback(pwd)
                                        }, function() {
                                            failureCallback()
                                        })
                                    }

                                    var cached = PdfFilesCache.get(file)
                                    if (cached) {
                                        return successCallback(cached.pdf)
                                    }

                                    if (file.link) {
                                        console.log("file link", file.link);
                                        PDFJS.getDocument({
                                            url: file.link,
                                            httpHeaders: file.httpHeaders
                                        }, undefined, passwordCallback, progressCallback).then(callback).catch(failure)
                                    } else {
                                        var fileReader = new FileReader();
                                        fileReader.onload = function() {
                                            PDFJS.getDocument({
                                                data: new Uint8Array(this.result)
                                            }, undefined, passwordCallback).then(callback).catch(failure)
                                        }

                                        fileReader.readAsArrayBuffer(file);
                                    }
                                }
                            }

                        })()
                    </script>
                    <script>
                        $(function() {
                            function showFilesSummary(message) {
                                var $wrap = $('#pdf-files-summary-wrap')
                                $wrap.find('.message').html(message)
                                $wrap.fadeIn()
                            }

                            function renderSummaryOfFiles(files) {
                                //console.log('renderSummaryOfFiles')

                                var counter = files.length

                                if (counter > 0) {
                                    var message = '<strong>' + counter + '</strong> ' + (counter > 1 ? 'files' : 'file') + ' selected'
                                    if (counter == 1) {
                                        message = '<em>Selected:</em> ' + files[0].name.truncateMiddle(60);
                                        $('#pdf-files-summary-help').hide()
                                    }
                                    showFilesSummary(message)
                                    nextStep()
                                }
                            }

                            function renderSummaryIfMultipleFiles(files) {
                                var counter = files.length

                                if (counter == 0) return

                                if (counter > 1) {
                                    var message = '<strong>' + counter + '</strong> ' + (counter > 1 ? 'files' : 'file') + ' selected'
                                    if (counter == 1) {
                                        message = '<em>Selected:</em> ' + files[0].name.truncateMiddle(60);
                                    }
                                    showFilesSummary(message)
                                }

                                nextStep()
                            }

                            function openFilesAndThen(otherFn) {
                                return function(files, closeOnDone) {
                                    var counter = 0;

                                    function onFileOpened() {
                                        counter += 1
                                    }

                                    function onAllFilesOpened() {
                                        if (counter > 0) {
                                            $('.doc-loading').hide()
                                            showSecondStep()
                                            otherFn(files, counter)
                                        }
                                    }

                                    hideFirstStep()

                                    openFiles(files, onFileOpened, onAllFilesOpened, closeOnDone)
                                }
                            }

                            $('.upload-btn-group').css('opacity', '1')

                            var pro = $('body').attr('data-pro-user') == 'true'
                            var dataMultipleFiles = $('#task-content').attr('data-multiple-files')
                            var canMultiple = dataMultipleFiles == 'true' || (pro && dataMultipleFiles == 'pro')
                            var maybeMultiple = dataMultipleFiles != 'false'

                            if (!maybeMultiple) {
                                $('.fileupload').removeAttr('multiple');
                                $('.upload-btn-group').find('.plural').hide();
                                $('.upload-btn-group').find('.singular').show();
                            }

                            var fileWrapItemTemplate = handlebars('#pdf-file-item-wrap-template')
                            var $filesList = $('#pdf-files-list')

                            function openFilesAndRenderListOfFiles(files) {
                                if (files.length == 0) return

                                var task = $('#task-content').attr('data-task')

                                function count() {
                                    return $('.pdf-file-item').length
                                }

                                var counter = 0

                                function onFileOpened(file) {
                                    counter += 1

                                    var data = {
                                        color: count() % 10 + 1,
                                        order: count() + 1,
                                        originalName: file.name,
                                        name: file.name,
                                        encodedName: encodeURIComponent(file.name),
                                        counter: file.counter
                                    }

                                    var $file = $(fileWrapItemTemplate(data))
                                    $filesList.append($file)
                                }

                                function onAllFilesOpened() {
                                    if (counter == 0) return;

                                    $(document).trigger('filesListRendered', {
                                        files: files
                                    })
                                    $('#pdf-files-list-wrap').show()
                                    showSecondStep()
                                    $('.doc-loading').hide()
                                }

                                hideFirstStep();

                                // let's open the files so we prompt for passwords, if the case
                                openFiles(files, onFileOpened, onAllFilesOpened, true)
                            }

                            function renderListOfFiles(files) {
                                if (files.length == 0) return;

                                var task = $('#task-content').attr('data-task');

                                function count() {
                                    return $('.pdf-file-item').length;
                                }

                                hideFirstStep();

                                var counter = 0;

                                files.forEach(function(file) {
                                    counter += 1;

                                    var data = {
                                        color: count() % 10 + 1,
                                        order: count() + 1,
                                        originalName: file.name,
                                        name: file.name,
                                        encodedName: encodeURIComponent(file.name),
                                        counter: file.counter
                                    }

                                    var $file = $(fileWrapItemTemplate(data));
                                    $filesList.append($file);
                                });

                                $(document).trigger('filesListRendered', {
                                    files: files
                                });
                                $('#pdf-files-list-wrap').show();
                                showSecondStep();
                                $('.doc-loading').hide()
                            }

                            function handlebars(id) {
                                var $template = $(id)
                                if ($template.length > 0) {
                                    var result = Handlebars.compile($template.html());
                                    $template.remove();
                                    return result;
                                }
                            }

                            var alternateMixTemplate = handlebars('#pdf-file-item-wrap-alternate-mix-template');

                            function openFilesAndRenderListOfFilesForAlternateMix(files) {
                                if (files.length == 0) return;

                                var task = $('#task-content').attr('data-task')

                                function count() {
                                    return $('.pdf-file-item').length
                                }

                                var counter = 0

                                function onFileOpened(file) {
                                    counter += 1

                                    var data = {
                                        color: count() % 10 + 1,
                                        order: count() + 1,
                                        originalName: file.name,
                                        encodedName: encodeURIComponent(file.name),
                                        name: file.name,
                                        counter: file.counter
                                    }

                                    var $file = alternateMixTemplate(data)
                                    $filesList.append($file)
                                }

                                function onAllFilesOpened() {
                                    if (counter == 0) return;

                                    $(document).trigger('filesListRendered', {
                                        files: files
                                    })
                                    $('#pdf-files-list-wrap').show()

                                    showSecondStep();
                                    $('.doc-loading').hide()
                                }

                                hideFirstStep();

                                // let's open the files so we prompt for passwords, if the case
                                openFiles(files, onFileOpened, onAllFilesOpened, true)
                            }

                            var $pdfCanvasList = $('#pdf-canvas-list');
/*
                            function renderPdfFilePages(file, callback) {
                                PdfFiles.getDocument(file, function(pdf) {
                                    if (file.counter == 1) {
                                        $('#pdf-canvas-wrap').show()
                                        $('html, body').animate({
                                            scrollTop: 200
                                        }, 1000);
                                    }

                                    for (var i = 1; i <= pdf.numPages; i++) {
                                        renderPdfPage(pdf, file, i)
                                    }

                                    callback();
                                });
                            }

                            function renderPages(files, callback) {
                                if (files.length == 0) {
                                    $('.doc-loading').hide();
                                    return callback();
                                }

                                var head = files[0];
                                var tail = files.slice(1);

                                renderPdfFilePages(head, function() {
                                    renderPages(tail, callback)
                                })
                            }

                            function renderPdfPage(pdf, file, pageNum) {
                                var thumbsSize = parseInt(window.localStorage.getItem('thumbnails-size')) || 150;
                                var rotateButtonClass = "btn btn-default page-tools-btn";
                                if (thumbsSize <= 200) {
                                    rotateButtonClass = "btn btn-default btn-xs page-tools-btn";
                                }
                                console.log("renderpdfpage function");
                                console.log('Rendering page wrap', pageNum, file.name)
                                var $pageWrap = $('<li class="pdf-page-wrap" data-filename="' + encodeURIComponent(file.name)
                                        + '" data-file-counter="' + file.counter + '" data-page="' + pageNum + 
                                        '"><div class="pdf-page-number">' + pageNum + 
                                        '</div><button type="button" class="btn btn-default btn-xs pdf-delete-page page-tools-btn">\n\
                        <i class="fa fa-times"></i></button><div class="pdf-rotate"><div class="btn-group" role="group"><button type="button" class="' 
                + rotateButtonClass + '" data-rotation="-90"><i class="fa fa-rotate-left"></i></button><button type="button" class="' 
                + rotateButtonClass + '" data-rotation="90"><i class="fa fa-rotate-right"></i></button></div></div><canvas class="pdf-page magnify pdf-canvas-page-' 
                + file.counter + '-' + pageNum + '" style="height: 210px;" id="pdf-canvas-page-' + file.counter + '-' + pageNum + 
                '"></canvas><div class="magnified" id="pdf-page-zoom-' + file.counter + '-' + pageNum + '"></div></li>')
                                $pageWrap.attr('id', 'pdfPageWrap' + pageNum);

                                var f = thumbsSize / 150;                        console.log($pageWrap);
                                $pageWrap.find('.pdf-page,.pdf-page-number').css('width', thumbsSize + 'px').css('max-height', Math.round(210 * f) + 'px')

                                $pdfCanvasList.append($pageWrap);

                                $(document).trigger('pdfPageRendered', {
                                    file: file,
                                    pageNum: pageNum
                                });
                                
                            }
*/
                            function _renderPdfPage(pdf, file, pageNum, callback) {    console.log(pageNum);
                                // there can be more than one
                                var canvas = document.getElementById('pdf-canvas-page-' + file.counter + '-' + pageNum);
                                if ($(canvas).attr('data-rendered') == 'true') {
                                    //console.log('Already rendered', pageNum)
                                    return;
                                }

                                $(canvas).attr('data-rendered', 'true');

                                //console.log('Rendering page', pageNum, file.name)
                                pdf.getPage(pageNum).then(function(page) {
                                    console.log(page);
                                    var desiredWidth = 150 * 7;
                                    var viewport = page.getViewport(1);
                                    var scale = desiredWidth / viewport.width;
                                    var scaledViewport = page.getViewport(scale);


                                    var context = canvas.getContext('2d');
                                    canvas.height = scaledViewport.height;
                                    canvas.width = scaledViewport.width;
                                    $(canvas).css('height', '').attr('data-scale', scale);

                                    var renderContext = {
                                        canvasContext: context,
                                        viewport: scaledViewport
                                    };

                                    var renderTask = page.render(renderContext);
                                    return renderTask.promise.then(
                                        function pdfPageRenderCallback() {
                                            // we drew the page on one of the canvases. there might be more canvases for a single pdf page, copy the drawing to the rest
                                            $('.pdf-canvas-page-' + file.counter + '-' + pageNum).not('[data-rendered=true]').each(function() {
                                                var currentCanvas = this

                                                $(currentCanvas).attr('data-rendered', 'true').css('height', '')
                                                var context = this.getContext('2d');

                                                //set dimensions
                                                currentCanvas.width = canvas.width;
                                                currentCanvas.height = canvas.height;

                                                //apply the old canvas to the new one
                                                context.drawImage(canvas, 0, 0);
                                            })

                                            callback(null);
                                            $(document).trigger('pdfPageRenderedLazy', {
                                                file: file,
                                                pageNum: pageNum
                                            });

                                            page.cleanup()
                                            page = null
                                        },
                                        function pdfPageRenderError(error) {
                                            callback(error);
                                            page.cleanup()
                                            page = null
                                        }
                                    );
                                });
                            }

                            function renderVisiblePageThumbs() {
                                $('.pdf-page-wrap').each(function() {
                                    var $this = $(this);
                                    if ($this.isInViewport()) {
                                        var page = parseInt($this.attr('data-page'));
                                        var counter = $this.attr('data-file-counter');

                                        if (typeof page != 'undefined' && typeof counter != 'undefined') {
                                            //console.log('Should render page', page)
                                            var cached = PdfFilesCache.get(counter)
                                            if (cached) {
                                                var pdf = cached['pdf']
                                                var file = cached['file']
                                                _renderPdfPage(pdf, file, page, function() {})
                                            } else {
                                                console.log('Cant render', page, counter, 'nothing found in cache')
                                            }
                                        }
                                    }
                                })
                            }

                            $(document).scrollStopped(function() {
                                //console.log('Scroll stopped')
                                renderVisiblePageThumbs()
                            })

                            $(document).on('renderVisiblePageThumbs', renderVisiblePageThumbs)

                            var nextStepPerformed = false;

                            function hideFirstStep() {
                                $('.step1').hide();
                                $('#how-it-works').remove();
                            }

                            function showSecondStep() {
                                $('.step2').show();
                                $('html, body').animate({
                                    scrollTop: 200
                                }, 1000);
                            }

                            function nextStep() {                                
                                if (nextStepPerformed) return;
                                nextStepPerformed = true;                       console.log('nextStep', nextStepPerformed);

                                hideFirstStep();
                                showSecondStep();
                            }

                            function openFiles(files, eachDoneCallback, allDoneCallback, closeOnDone) {      console.log('openFiles');
                                if (files.length == 0) return allDoneCallback();

                                closeOnDone = closeOnDone || false;

                                var head = files[0]
                                var tail = files.slice(1)

                                function whenDone(pdf) {
                                    eachDoneCallback(head);
                                    if (closeOnDone) {
                                        console.log('Closing pdf doc');
                                        pdf.destroy();
                                    }
                                    openFiles(tail, eachDoneCallback, allDoneCallback);
                                }

                                function whenFailed(reason) {
                                    openFiles(tail, eachDoneCallback, allDoneCallback)
                                }

                                console.log('Opening', head)
                                PdfFiles.getDocument(head, whenDone, whenFailed)
                            }
/*   openFilesAndRenderPagesOfFirstFile 
                            function openFilesAndRenderPagesOfFirstFile(files) {
                                return openFilesAndRenderPages([files[0]])
                            }
*/
                            // combine reorder page specific
                            var firstFilesOpened = true;

                            /*function openFilesAndRenderPagesForCombineReorder(files) {
                                nextStep();

                                if (firstFilesOpened) {
                                    $('#pdf-canvas-list').hide();
                                    firstFilesOpened = false;
                                }

                                renderPages(files, function() {
                                    // page will take over and render more
                                    $(document).trigger('pagesRendered', {
                                        files: files
                                    })
                                })
                            }

                            function openFilesAndRenderPages(files) {
                                nextStep();

                                renderPages(files, function() {
                                    $(document).trigger('pagesRendered', {
                                        files: files
                                    })
                                    renderVisiblePageThumbs();
                                })
                            }*/

                            function allowOnlyPDFs(inFiles, showAlerts) {
                                if (inFiles.length == 0) return []

                                var outFiles = _.filter(inFiles, function(f) {
                                    var lowerName = f.name.toLowerCase()
                                    return undefined != _.find(filetypes, function(filetype) {
                                        return lowerName.endsWith("." + filetype)
                                    })
                                })

                                if (showAlerts && inFiles.length != outFiles.length) {
                                    if (outFiles.length == 0) {
                                        showAlert('Please select ' + filetypes.join(', ').toUpperCase() + ' files')
                                    } else {
                                        showAlert('Some files were ignored, please select only ' + filetypes.join(', ').toUpperCase() + ' files', 'warning')
                                    }
                                }

                                return outFiles
                            }

                            function allowOnlyNonZeroSizedFiles(inFiles, showAlerts) {
                                if (inFiles.length == 0) return []

                                var outFiles = _.filter(inFiles, function(f) {
                                    return typeof f.size == 'undefined' || f.size > 0
                                })

                                if (showAlerts && inFiles.length != outFiles.length) {
                                    if (outFiles.length == 0) {
                                        showAlert('Unreadable file')
                                    } else {
                                        showAlert('Some files were ignored, unreadable files', 'warning')
                                    }
                                }

                                return outFiles
                            }

                            function allowOnlyFilesUnderSizeLimit(inFiles, showAlerts) {
                                if (inFiles.length == 0) return []

                                if (pro) return inFiles

                                var limit = $('#task-content').attr('data-free-max-file-size')
                                if (!limit) return inFiles

                                var outFiles = _.filter(inFiles, function(f) {
                                    return typeof f.size != 'undefined' && f.size < limit * 1000000
                                })

                                if (showAlerts && inFiles.length != outFiles.length) {
                                    showUpgradePopupIf('free-file-size')
                                    Analytics.trackEvent('paywall', 'free-file-size', task)
                                }

                                return outFiles
                            }

                            function allowMultipleFilesIf(inFiles, showAlerts) {
                                if (inFiles.length == 0) return []

                                if (pro) return inFiles

                                var outFiles = inFiles
                                if (outFiles.length > 1 && !canMultiple) {
                                    if (showAlerts) {
                                        showUpgradePopupIf('free-multiple-files')
                                        Analytics.trackEvent('paywall', 'free-multiple-files', task)
                                    }

                                    // keep only first file
                                    outFiles = [outFiles[0]]
                                }

                                return outFiles
                            }

                            var task = $('#task-content').attr('data-task');

                            function handleFiles(e, data) {
                                _.each(data.files, function(file) {
                                    // ensure each file has a unique counter assigned.
                                    file.counter = globalFilesCounter++;
                                });

                                var originalFiles = _.map(data.files, function(file) {
                                    return file;
                                })

                                var files = allowOnlyPDFs(originalFiles, true)
                                files = allowOnlyNonZeroSizedFiles(files, true);
                                files = allowOnlyFilesUnderSizeLimit(files, true);
                                files = allowMultipleFilesIf(files, true);

                                if ($('#task-content').attr('data-multiple-files') == 'false' && files.length > 1) {
                                    files = [files[0]];
                                }

                                if (files.length == 0) return;

                                $(document).trigger('filesSelected', {
                                    files: files
                                });
                            }

                            var globalFilesCounter = 1;

                            $(document).on('filesSelected', function(e, data) {
                               
                                if (data.files[0] && data.files[0].link) {
                                    $('.doc-loading').show();
                                }

                                var files = data.files;
                                switch (task) {
                                    case "splitByPages":
                                    case "extractPages":
                                    case "deletePages":
                                    case "pdfToJpg":
                                    case "rotatePages":
                                    case "resizePages":
                                        openFilesAndRenderPagesOfFirstFile(files);
                                        renderSummaryIfMultipleFiles(files);
                                        break
                                    case "merge":
                                        renderListOfFiles(files)
                                        break
                                    case "alternateMix":
                                        openFilesAndRenderListOfFilesForAlternateMix(files)
                                        break
                                    case "combineReorder":
                                       // openFilesAndRenderPagesForCombineReorder(files);
                                        break;
                                    case "docToPdf":
                                    case "jpgToPdf":
                                    case "repair":
                                        renderSummaryOfFiles(files);
                                        break;
                                    case "edit":
                                                                                                          console.log('task', task);
                                        // nothing else required, editor has special rendering
                                        nextStep();
                                        break;
                                    case "crop":
                                    case "splitByBookmarks":
                                    case "splitByText":
                                    case "watermark":
                                        renderSummaryIfMultipleFiles(files);
                                        // task has custom rendering of UI in task page
                                        break;
                                    default:
                                         
                                        openFilesAndThen(renderSummaryOfFiles)(files, true)
                                        break
                                }

                                if ($('#task-content').attr('data-auto-submit') == 'true') {             console.log('autosubmit==true');
                                    setTimeout(function() {
                                        $('form.task-form button[type=submit]').click();
                                    }, 1000);
                                }
                            })

                            function gDriveSuccess(files) {
                                //console.log('GDrive files picked', files)
                                var task = $('#task-content').attr('data-task');

                                files = _.map(files, function(file) {
                                    var unsupported = _.find(files, function(file) {
                                        return file.error
                                    })

                                    if (unsupported) {
                                        console.log(JSON.stringify(unsupported));
                                        var message = unsupported.message || 'Please contact support for more information.';
                                        alert("Could not access the Google Drive files. " + message);
                                        Analytics.trackEvent('gdriveFilesFailed', JSON.stringify(unsupported))
                                        return;
                                    }

                                    var downloadUrl = file.downloadUrl; //download file

                                    // extension expected
                                    var fileExtensions = ['pdf']
                                    var exportMimeType = 'application/pdf'
                                    if (task == 'docToPdf') {
                                        fileExtensions = ['docx']
                                        exportMimeType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
                                    } else if (task == 'jpgToPdf') {
                                        fileExtensions = ['jpeg', 'jpg', 'png', 'tif', 'tiff', 'gif', 'bmp']
                                        exportMimeType = 'image/jpeg'
                                    }

                                    if (downloadUrl) {
                                        // check the format is what the task supports
                                        if (file.fileExtension && fileExtensions.indexOf(file.fileExtension.toLowerCase()) == -1) {
                                            showAlert('File <strong>' + file.title + '</strong> can\'t be used for the selected task.', 'warning')
                                        }
                                    } else {
                                        if (file.exportLinks) {
                                            // a google format, needs to be accessed via export link
                                            var exportLink = file.exportLinks[exportMimeType]
                                            if (!exportLink) {
                                                showAlert('File <strong>' + file.title + '</strong> can\'t be used for the selected task.', 'warning')
                                                return;
                                            }

                                            downloadUrl = exportLink
                                        }
                                    }

                                    if (!downloadUrl) {
                                        if (file.labels && file.labels.restricted === true) {
                                            showAlert("You selected a Google Drive file with restricted access", 'danger');
                                            Analytics.trackEvent('gdriveFilesFailed', 'restricted_access');
                                            return;
                                        }

                                        console.log(JSON.stringify(file));
                                        var errMsg = file.message || 'Please contact support for more information.';
                                        alert("Could not access the Google Drive files. " + errMsg);
                                        Analytics.trackEvent('gdriveFilesFailed', JSON.stringify(file));
                                        return;
                                    }

                                    file.link = downloadUrl
                                    if (file.accessToken || (downloadUrl.indexOf('dropbox') >= 0 && downloadUrl.indexOf('u/76907') < 0)) {
                                        file.link += "&originalFilename=" + encodeURIComponent(file.title) +
                                            "&promo=" + (file.promo || '') +
                                            "&expires_at=" + (file.expires_at || '') +
                                            "&oauth_bearer=" + encodeURIComponent(file.accessToken);
                                    }
                                    file.size = parseInt(file.fileSize)
                                    file.bytes = file.size
                                    file.name = file.title
                                    file.httpHeaders = {
                                        'Authorization': 'Bearer ' + file.accessToken
                                    }
                                    file.scope = 'task-file'

                                    FileUploadExpirationWarning.add(file);

                                    return file
                                })

                                files = allowMultipleFilesIf(files, true)

                                if (dataMultipleFiles == 'false' && files.length > 1) {
                                    files = [files[0]]
                                }

                                $(document).trigger('filesSelected', {
                                    files: files
                                })

                                _.each(files, function(file) {
                                    uploadFileFromDropboxOrGDrive(file)
                                })

                                Analytics.trackEvent('gdriveFilesSelected', files.length)
                            }

                            $('.gdrive-chooser').click(function() {
                                var options = {
                                    multiple: canMultiple,
                                    success: gDriveSuccess,
                                    filetypes: filetypes
                                };

                                GoogleApis.load(function() {
                                    GoogleApis.loadPicker(function() {
                                        if (typeof GoogleDrive !== 'undefined') {
                                            GoogleDrive.choose(options)
                                        } else {
                                            alert("We couldn't connect to Google Drive. Try refreshing the page or try again later if the problem persists.")
                                        }
                                    })
                                })
                            });

                            try {
                                var filesParam = getQueryParameterByName('files');
                                if (filesParam) {
                                    var files = JSON.parse(filesParam);

                                    setTimeout(function() {
                                        gDriveSuccess(files);
                                        // remove files param
                                        try {
                                            var urlWithoutFilesParam = [location.protocol, '//', location.host, location.pathname].join('');
                                            var partnerKey = getQueryParameterByName('partnerKey');
                                            if (partnerKey) {
                                                urlWithoutFilesParam += '?partnerKey=' + encodeURIComponent(partnerKey);
                                            }
                                            window.history.pushState({}, '', urlWithoutFilesParam);
                                        } catch (e) {}
                                    }, 500)

                                }
                            } catch (e) {
                                console.error(e.stack)
                            }

                            $('.drpbox-chooser').click(function() {
                                var options = {
                                    success: function(files) {
                                        $(document).trigger('filesSelected', {
                                            files: files
                                        })

                                        for (var i = 0; i < files.length; i++) {
                                            files[i].expires_in = 4 * 3600; // 4 hours
                                            files[i].scope = 'task-file';
                                            uploadFileFromDropboxOrGDrive(files[i])
                                        }

                                        Analytics.trackEvent('dropboxFilesSelected', files.length)
                                    },
                                    linkType: "direct",
                                    multiselect: canMultiple,
                                    extensions: _.map(filetypes, function(s) {
                                        return '.' + s
                                    })
                                };

                                if (typeof Dropbox !== 'undefined') {
                                    Dropbox.choose(options);
                                } else {
                                    alert("We couldn't connect to Dropbox.com. Try refreshing the page or try again later if the problem persists.")
                                }
                            })

                            PdfFiles.filesUploading = 0;

                            var $uploadProgressBar = $('#upload-progress .bar');

                            function updateFileUploadProgress(progress) {                         console.log('upload progress', progress);
                                $uploadProgressBar.css('width', progress + '%');
                                if (progress == 100) { 
                                    setTimeout(function() {
                                        $uploadProgressBar.css('width', '0%');
                                    }, 1000);
                                }
                            }

                            function completeUploadProgressIfLastFileDone() {
                                if (PdfFiles.filesUploading < 0) {
                                    PdfFiles.filesUploading = 0;
                                }

                                if (PdfFiles.filesUploading == 0) {
                                    updateFileUploadProgress(100);
                                }
                                
                                                                                 //console.log('num of files', PdfFiles.filesUploading);
                            }

                            $(document).on('fileUploadStarted', function(e, data) {
                                                                                     console.log('fileUploadStarted', data.name, data.counter);
                                PdfFiles.filesUploading += 1;
                                completeUploadProgressIfLastFileDone();
                            });
                            $(document).on('fileUploadFailed', function(e, data) {
                                console.log('fileUploadFailed', data.name, data.counter);
                                data.reason = data.reason || 'Failed to upload, try again';
                                Analytics.trackEvent('fileUploadFailed', data.reason, navigator.userAgent)

                                // showAlert(data.name.truncateMiddle(30) + ': ' + data.reason)

                                PdfFiles.filesUploading -= 1;
                                completeUploadProgressIfLastFileDone()
                            });

                            $(document).on('fileUploadDone', function(e, data) {
                                                                                        console.log('fileUploadDone', data.name, data.counter);
                                PdfFiles.filesUploading -= 1;
                                completeUploadProgressIfLastFileDone();
                            });

                            var ExpiringStorage = (function() {
                                    return {
                                        setItem: function(key, v, ttl) {
                                            ttl = ttl || 60 * 60 * 1000;
                                            var expiry = Date.now() + ttl;
                                            try {
                                                sessionStorage.setItem(key, JSON.stringify({
                                                    value: v,
                                                    expiry: expiry
                                                }))
                                            } catch (e) {
                                                console.error('ExpiringStorage.setItem failed', e);
                                            }
                                        },
                                        getItem: function(key) {
                                            var obj = window.sessionStorage.getItem(key);
                                            if (obj) {
                                                try {
                                                    var item = JSON.parse(obj)
                                                    if (Date.now() < item.expiry) {
                                                        return item.value;
                                                    } else {
                                                        window.sessionStorage.removeItem(key)
                                                        return undefined;
                                                    }
                                                } catch (e) {
                                                    // noop
                                                }
                                            }

                                            return undefined;
                                        }
                                    }
                                })()
                                /*file upload start **/
                            $('.fileupload,.image-fileupload').each(function(i, elem) {
                                    var dropZone = $(elem).attr('data-allows-drop') == "true" ? $(document) : null;
                                    var scope = $(elem).attr('data-scope');

                                    $(elem).fileupload({
                                        sequentialUploads: true,
                                        singleFileUploads: true,
                                        dropZone: dropZone,
                                        add: function(e, data) {

                                            _.each(data.files, function(file) {
                                                file.scope = scope;
                                            });

                                            var originalFiles = _.map(data.files, function(file) {
                                                return file;
                                            })

                                            if (scope == 'task-file') {
                                                var files = allowOnlyPDFs(originalFiles, false)
                                                files = allowOnlyNonZeroSizedFiles(files, false)
                                                files = allowOnlyFilesUnderSizeLimit(files, false)
                                                files = allowMultipleFilesIf(files, false)

                                                data.files = files;
                                            }

                                            for (var i = 0; i < data.files.length; i++) {console.log('trigger fileuploadstarted');
                                                $(document).trigger('fileUploadStarted', data.files[i]);
                                                
                                            }

                                            if (scope == 'task-file') {
                                                // partition files by previous or fresh uploads
                                                var freshUploads = [];
                                                _.each(data.files, function(f) {
                                                    // assign key to each file
                                                    f.key = encodeURIComponent('file.' + f.name + '.' + f.size);
                                                    // check if this is a previously uploaded file
                                                    var previousId = ExpiringStorage.getItem(f.key);
                                                    if (previousId) {
                                                        f.id = previousId;
                                                        f.expires_in = 4 * 3600; // reduced by one hour, local cache time, see ExpiringStorage
                                                        FileUploadExpirationWarning.add(f);
                                                        $(document).trigger('fileUploadDone', f);
                                                    } else {
                                                        freshUploads.push(f);
                                                    }
                                                });

                                                // don't upload previously uploaded files, we know their ids
                                                data.files = freshUploads;
                                            }
                                            /* sig in  
                                            if (data.files.length > 0) { //
                                                //console.log(data.files.length);
                                                Analytics.trackEvent('fileUploadStarted', data.files.length)

                                                $.getJSON('/api/files/sign', function(signed) {
                                                    data.formData = signed;
                                                    data.submit();
                                                }).fail(function(jqXHR, textStatus, errorThrown) {
                                                    if (jqXHR.status == 429) {
                                                        showUpgradePopup('files-per-hour')
                                                        data.files[0].reason = 'Reached the limit on files per hour'
                                                    }

                                                    $(document).trigger('fileUploadFailed', data.files[0])
                                                });
                                            }*/ data.submit();
        //$(document).trigger('fileUploadDone', data.files[0]);
                                        },
                                        progressall: function(e, data) {
                                            var progress = parseInt(data.loaded / data.total * 100, 10);
                                            if (progress > 95) progress = 95;

                                            updateFileUploadProgress(progress);                        console.log('upload progress: ', progress);
                                        },
                                        done: function(e, data) {$(document).trigger('fileUploadDone', data.files[0]);
                                            /*var url = data.jqXHR.getResponseHeader('Location'); console.log('upload done', url);
                                            $.jsonPost('/api/files', {
                                                    url: url
                                                })
                                                .done(function(result) {
                                                    data.files[0].id = result.id;
                                                    data.files[0].expires_in = 5 * 3600;
                                                    $(document).trigger('fileUploadDone', data.files[0]);

                                                    if (scope == 'task-file') {
                                                        FileUploadExpirationWarning.add(data.files[0]);
                                                        ExpiringStorage.setItem(data.files[0].key, data.files[0].id);
                                                        localStorage.setItem('lastFileUploadUrl', url);
                                                    }
                                                })
                                                .fail(function(jqXHR, textStatus, errorThrown) {
                                                    data.files[0].debugInfo = jqXHR;
                                                    if (jqXHR.status == 429) {
                                                        showUpgradePopup('files-per-hour')
                                                        data.files[0].reason = 'Reached the limit on files per hour'
                                                    }

                                                    $(document).trigger('fileUploadFailed', data.files[0])
                                                })*/
                                        },
                                        fail: function(e, data) {
                                            if (data.jqXHR.responseText && data.jqXHR.responseText.indexOf('Idle connections will be closed') > 0) {
                                                data.files[0].reason = 'Your connection timed out, try again.'
                                            }

                                            data.files[0].debugInfo = data.jqXHR
                                            $(document).trigger('fileUploadFailed', data.files[0])
                                        }
                                    });
                                })
                                /*file upload end **/
                            function filenamesOf(data) {
                                return _.map(data.files, function(f) {
                                    return f ? f.name : undefined;
                                }).join(', ');
                            }

                            $('.fileupload').each(function(i, elem) {
                                var $elem = $(elem);
                                $elem.bind('fileuploaddrop', function(e, data) {
                                    console.log('fileuploaddrop', filenamesOf(data));
                                    handleFiles(e, data);
                                });
                                $elem.bind('fileuploadchange', function(e, data) {
                                    console.log('fileuploadchange', filenamesOf(data));
                                    handleFiles(e, data);
                                });
                                
                            });

                            function uploadFileFromDropboxOrGDrive(data) {
                                // ensure each file has a unique counter assigned.
                                data.counter = globalFilesCounter++;
                                data.scope = 'task-file';

                                $(document).trigger('fileUploadStarted', data)

                                $.jsonPost('/api/files', {
                                        url: data.link
                                    })
                                    .done(function(result) {
                                        data.id = result.id;
                                        data.pages = result.pages;
                                        data.passwordProtected = result.passwordProtected;
                                        $(document).trigger('fileUploadDone', data)
                                    })
                                    .fail(function(jqXHR) {
                                        if (jqXHR.status == 429) {
                                            showUpgradePopup('files-per-hour');
                                            data.reason = 'Reached the limit on files per hour'
                                        } else if (jqXHR.status == 400 && jqXHR.responseText) {
                                            data.reason = jqXHR.responseText
                                        }
                                        $(document).trigger('fileUploadFailed', data)
                                    })
                            }
                        })
                    </script>
                </section>
                <section style="display: none" class="doc-loading">
                    <div class="progress-radial progress-0">
                        <div class="overlay">0%</div>
                    </div>
                    <div>Loading, please wait...</div>
                </section>
                <section style="display: none" class="page-loading">
                    <div class="progress-radial progress-5">
                        <div class="overlay">1%</div>
                    </div>
                    <div>Loading, please wait...</div>
                </section>
                
                <section class="scroll-here-step2">
                    <div id="edit-pages-wrap" style="display: none" class="centered">
                        <div style="display: none" id="global-help-hint"></div>
                        <div id="edit-pages">
                            <div style="display: none" class="tools-menu edit-menu" id="tools-menu">
                                <div aria-label="Tools" role="group" class="btn-group wrap">
                                    <button data-tool="text" title="Add new text or Edit existing text of PDF Page" class="btn btn-default" type="button"><i class="fa fa-i-cursor"></i><i style="margin-left: -5px;" class="fa fa-font"></i> Text</button>
                                    <button data-tool="link" title="Add external link" class="btn btn-default" type="button"><i class="fa fa-link"></i> Link</button>
                                    <!-- -->
                                    <div class="btn-group">

                                        <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" title="Add Shapes to PDF Page" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-file-pdf-o" aria-hidden="true"></i>PDF<span class="caret"></span></button>

                                        <ul class="dropdown-menu shape-opts">
                                            <li> <button data-tool="link" title="Add external link" class="btn btn-default" type="button"><i class="fa fa-link"></i> Link</button></li>
                                            <li> <button data-tool="target" title="Add external Target" class="btn btn-default" type="button"><i class="fa fa-link"></i> Target pdf</button></li>

                                            <!-- <li><a data-shape="rectangle" href="javascript://"><i class="fa fa-square-o"></i> Rectangle</a></li>-->
                                        </ul>
                                    </div>

                                    <!-- -->
                                    <div class="btn-group">
                                        <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" title="Fill Forms" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-id-card-o"></i> Forms<span class="caret"></span></button>
                                        <ul class="dropdown-menu forms-opts">
                                            <li class="default">
                                                <section class="non-interactive-forms-opts">
                                                    <a class="activate-text-tool" href="javascript://"><i class="fa fa-i-cursor"></i><i style="margin-left: -5px;" class="fa fa-font"></i></a>
                                                    <!--      <a href="javascript://"><img style="width: 20px" data-src="/images/pages/pdf-editor/forms-xmark.png" src="" class="deferred"></a>
                                                    <a href="javascript://"><img style="width: 20px" data-src="/images/pages/pdf-editor/forms-checkmark.png" src="" class="deferred"></a>
                                                    <a href="javascript://"><img style="width: 20px" data-src="/images/pages/pdf-editor/forms-black-dot.png" src="" class="deferred"></a>
                                               --></section>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="btn-group">
                                        <button data-tool="image" aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" title="Add Image to PDF Page" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-picture-o"></i> Images<span class="caret"></span></button>
                                        <ul class="dropdown-menu image-opts">
                                            <li class="image-entry">
                                                <!--    <a href="javascript://"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPEAAABVCAYAAACYRgLxAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABMFJREFUeNrsndtx2kAUQJcMDcj//oFxBbgEXAIuQS4BSrBLQCVYJZgSTAUZ+yf/UQkKSlYZBoP2SvsUPmdmByfDY73W2Xv3oWVS17UCgPEyaSSubu8wGWBkZL9+TprHHzQFwLhBYoCRM70UogEgPc4NfYnEAKTTAIDEAIDEAEgMAEgMAEgMAEgMgMQAgMQAgMQAgMQASAwASAwASAwASAyAxACAxACAxADwhWmoD/p9e5cfHlaWb7PTj/ujn13jop6fR2WvH0OyOJR3w3OqQ5nrxxTb0MRGt+0p60N5DtnYN5HPpZsG/KzsUJaW73H6+lLLXCRWz1P2uq6FJ2nOSST5PZvnvST6t5Z8BlxBOt309tsm0OseOFUWOjp8BIhQWY/PyFEAiVMh05K8a2FSruer7nh8RmFplJoFiJiAxL0j3tsIIkzuMXPIPT8fkDhItNuO4OJ89hAFVzq6+n4NIHEQtomn1spDNM4t5AckdsKko9wfypPqt7T0pvzMYnbV8+ZQHtW/2WgTS4cdjc34dp3Y31pSLl0HL8LXb4bWsVlSOi5ILKdZpmmWaB50kSzVZBEu0EoL/Kg7HYnIIaJ6ZWgnxsZE4qA0vfBcnV/sP3dxxxrzFcq8hu1CYtOy0qegHqTUSBycSkc7SUSOeYGa0moX6bRpWakQ1MNlag9ILOZTOLaJmSqaxvCZI4lNHclekLmQUiNxtJTVtDd5pq53GcW0RFQetU8peC+2MyJxkimrq7Fnipii5+6kwzNlBURjJE4yZXWVtg6NlLZ178owloZ5g+Lk36VlpwBI7AXJLHWsSRuTFDa3KZqWlYoBWUuo/dS1RYErlFi6ZhxDYJMQ+4HvLblbqbzwf5Wg3oDE35ZWrma3mORupdKig8gMncO+R4Q+HQKwnxqJr5quVK+5t/lVmJLaHBKQC97bpuNg8wcSB0Uy3t0lVudG3s3A10oiZTkwSkvH24DEwSVOjSfPUbiykLwdFjA2HgHTK/k9JKlfKpG4jcBDx8KS2WPJjR+ZsF0LT+2wQz8kblkKLupKDZ8FdsleR2CbuuRC+VaO2nbhqe0e0I90ukVyPGmRSF03lkLESHFJqYnEXpGe3uFa4l1Hqjsz1PfeYiwcY2/zSnc+FbogsUva0y1zocCuD29/6KjXR4doM2V31vM6Ulv7Op8avmE6PdMX8rtQYJtlnCFUgov9WQ2bTV+qeBswSKmJxGLeDAL3vYhtlnGGUuiOJhOk1WMRqZ0RZ0aZSCyKNpfKEIHLCL+DJBoveqbGM2WebZYeEHeuPCXeicAVpdN9BI45Iy3ZbNHn7C/p2N9nfdlPjcTBouCjir+kJBmLt4fcK8HzJDf+207eSdqM/dRI7JUmnZxHSqEvSWESaykQQ7KsVDqqrwn2UyOxc9qD8uYqzbVMybLM1iDpWtAGhaO2lBzqx9gYia0vskILe6/lfVHhv8TbZTTuSqslE3ouhw7cojhCJnVdq+r27v+RJ1kCX0sBAOc55yqHAgCQTgMAEgMAEgMgMQAgMQAgMQAgMQASAwASAwASAwASAyAxACAxACAxACAxABIDABIDABIDABIDIDEAIDEAuOPLtyIeH4kJAERiAEBiAOji7zdAAMB4+SPAACC4BF2/j5LPAAAAAElFTkSuQmCC"></a>
                                          --></li>
                                            <li class="divider" role="separator"></li>
                                            <li style="margin-top: 10px; margin-bottom: 10px;">
                                                <span type="button" class="fileinput-link btn btn-secondary" id="upload-image-link">
                                                    <i class="fa fa-plus"></i> New Image
                                                        <form data-filetypes="pdf" action="https://uploads1.sejda.com/" enctype="multipart/form-data" method="post" id="imageUploadForm">
                                                        <input name="key" type="hidden">
                                                        <input name="AWSAccessKeyId" type="hidden">
                                                        <input name="acl" type="hidden">
                                                        <input name="success_action_redirect" type="hidden">
                                                        <input name="policy" type="hidden">
                                                        <input name="signature" type="hidden">
                                                        <input name="Content-type" type="hidden">
                                                        <input name="x-amz-storage-class" type="hidden">
                                                        <input accept="image/*" title="Upload" multiple="multiple" data-scope="editor-image" data-url="" name="file" type="file" class="image-fileupload">
                                                        </form>
                                                </span>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="btn-group">
                                        <button data-tool="sign" aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" title="Add Signature to PDF Page" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-pencil-square-o"></i> Sign<span class="caret"></span></button>
                                        <ul class="dropdown-menu sign-opts">
                                            <li class="default">
                                                <!--   <a href="javascript://"><img src="data:image/png;base64,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"></a>
                                          --></li>
                                            <li class="divider" role="separator"></li>
                                            <li style="margin-top: 10px; margin-bottom: 10px;">
                                                <button class="btn btn-secondary" id="add-signature-link" type="button"><i class="fa fa-plus"></i> New Signature</button>
                                                <script>
                                                    $(function() {
                                                        $('#add-signature-link').click(function() {
                                                            $('#createSignatureModal').modal('show')
                                                        })
                                                    })
                                                </script>
                                            </li>
                                        </ul>
                                    </div>
                                    <button style="" data-tool="whiteout" title="Whiteout area of PDF Page" class="btn btn-default" type="button"><i class="fa fa-eraser"></i> Whiteout</button>
                                    <div class="btn-group">
                                        <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" title="Strikethrough or Highlight text on PDF Page" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-strikethrough"></i><i style="margin-left: -5px;" class="fa fa-underline"></i> Annotate<span class="caret"></span></button>
                                        <ul class="dropdown-menu">
                                            <li><a data-tool="strikethrough" title="Strikethrough Text in PDF Page" href="javascript://"><i class="fa fa-strikethrough"></i> Strikethrough</a></li>
                                            <li><a data-tool="highlight" title="Highlight Text in PDF Page" href="javascript://"><i class="fa fa-underline"></i> Highlight</a></li>
                                        </ul>
                                    </div>
                                    <div class="btn-group">
                                        <button data-tool="shape" aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" title="Add Shapes to PDF Page" class="btn btn-default dropdown-toggle" type="button"><i class="fa fa-circle-o"></i><i style="margin-left: -5px;" class="fa fa-square-o"></i> Shapes<span class="caret"></span></button>
                                        <ul class="dropdown-menu shape-opts">
                                            <li><a data-shape="ellipse" href="javascript://"><i class="fa fa-circle-o"></i> Ellipse</a></li>
                                            <li><a data-shape="rectangle" href="javascript://"><i class="fa fa-square-o"></i> Rectangle</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="display: none;"><canvas id="image-rotation-canvas"></canvas><canvas id="image-resize-canvas"></canvas></div>
                </section>
                <div style="display:none; margin-top: 40px" class="centered step2 bottom-fixed">
                    <form autocomplete="off" class="form-inline task-form">
                        <input value="edit" name="type" type="hidden">
                        <input value="" name="elapsedTime" type="hidden">
                        <div class="container centered">
                            <div class="row head-space">
                                <button class="btn btn-default btn-medium" type="submit" id="save-pdf-btn">Save <i class="fa fa-chevron-right"></i> </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div style="display: none" class="modal app-modal" id="removeUnusedTextPrompt">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span></button>
                                <div class="modal-title">
                                    There are some unused text edits. (the default <i>Text here</i>)<br> Should we remove them before continuing?
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-no btn-light btn-xs" type="button">No, don't remove</button>
                                <button class="btn btn-yes btn-xs" type="button">Yes, remove</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display: none" class="modal app-modal" id="recoveryPrompt">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span></button>
                                <div class="modal-title">
                                    You've previously made edits to this file.<br> Would you like to recover any unsaved changes?
                                </div>
                            </div>
                            <div class="modal-body">
                                <ol class="recovery-sessions"></ol>
                            </div>
                            <div class="modal-footer">
                                <button data-dismiss="modal" class="btn btn-light btn-xs btn-no" type="button">Discard</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display: none" class="modal app-modal" id="comingSoonModal">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span></button>
                                <div class="modal-title">Sorry, this feature is not yet available</div>
                            </div>
                            <div class="modal-footer">
                                <button data-dismiss="modal" class="btn btn-light btn-xs" type="button">Ok</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display: none" class="modal app-modal" id="createSignatureModal">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span></button>
                                <div class="modal-title">Create signatures</div>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <input value="Jane Appleseed" class="form-control" id="signatureName" type="text">
                                </div>
                                <div style="font-family: Stalemate;" class="signaturePreview first"></div>
                                <div style="font-family: 'Over the Rainbow';" class="signaturePreview"></div>
                                <div style="font-family: 'Caveat';" class="signaturePreview"></div>
                                <div style="font-family: 'Cedarville Cursive';" class="signaturePreview"></div>
                                <div style="font-family: 'Dancing Script';" class="signaturePreview"></div>
                                <div style="font-family: 'Give You Glory';" class="signaturePreview"></div>
                                <div style="font-family: 'Kristi';" class="signaturePreview"></div>
                                <div style="font-family: 'Mr De Haviland';" class="signaturePreview"></div>
                                <div style="font-family: 'Norican';" class="signaturePreview"></div>
                                <div style="font-family: 'Reenie Beanie';" class="signaturePreview"></div>
                                <div style="font-family: 'Satisfy';" class="signaturePreview"></div>
                                <div style="font-family: 'Zeyada';" class="signaturePreview"></div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-light btn-xs btn-ok" type="button">Add signature</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display:none" id="selectionBorder"></div>
               <!-- <script src="js/pages/2pdf.js">console.log("olivier add - log --to change the css position  ..... zzzzz2");</script>-->
                <script src="js/pages/pdf-editor.js">  </script>
                <script>
                    var idleTimeInMinutes = 0,
                        warnedAboutIdleness = false,
                        hasUnsavedWork = false;
                    $(document).ready(function() {

                        $(document).on('fileUploadDone', function(e, data) {
                            if (data.scope != 'task-file') return;
                            console.log("in html" + data);
                            hasUnsavedWork = true;
                            idleTimeInMinutes = 0;
                        });

                        setInterval(function() {
                            idleTimeInMinutes = idleTimeInMinutes + 1;
                            if (hasUnsavedWork && idleTimeInMinutes > 10 && !warnedAboutIdleness) {
                                warnedAboutIdleness = true;
                                alert('Please save your changes to avoid losing any unsaved work.')
                            }
                        }, 60000); // 1 minute

                        // Zero the idle timer on mouse movement or keys being pressed
                        $(this).mousemove(function(e) {
                            idleTimeInMinutes = 0;
                        });
                        $(this).keypress(function(e) {
                            idleTimeInMinutes = 0;
                        });

                        // when the changes are saved, reset unsaved work
                        $(document).on('taskSubmitDone', function() {
                            hasUnsavedWork = false;
                        });

                        // when an action takes place on a page, mark unsaved work
                        $(document).on('click', '.page-wrap', function() {
                            hasUnsavedWork = true;
                        });

                        // warn before navigating away, if that means losing unsaved work
                        window.onbeforeunload = function() {
                            if (hasUnsavedWork) {
                                return "Changes that you made may not be saved";
                            }
                        }
                    });
                </script>
                <script>
                    $(function() {

                    })
                </script>
                <script>
                    try {
                        if (!$('html').hasClass('unsupported') && navigator.userAgent.toLowerCase().indexOf("android") < 0) {
                            Raven.config('https://c9f778a3bf41450d82c5f9bd6f45a1e3@sentry.io/96554', {
                                shouldSendCallback: function(data) {
                                    if (!window.hasSentSentryError) {
                                        window.hasSentSentryError = true;
                                        return true;
                                    }
                                    return false;
                                },
                                release: '108',
                                whitelistUrls: [
                                    /sejda\.com/
                                ],
                                ignoreUrls: [
                                    // Chrome extensions
                                    /extensions\//i,
                                    /^chrome:\/\//i,
                                    // Ignores urls containing in "/affs?" a common extension for spyware.
                                    /\/\/(\w|\.)*\/affs\?/
                                ]
                            }).install();
                        }
                    } catch (e) {}
                </script>
                <script>
                    $(window).load(function() {
                        $('head').append('<link href="https://fonts.googleapis.com/css?family=Stalemate|Over+the+Rainbow|Caveat|Cedarville+Cursive|Dancing+Script|Give+You+Glory|Kristi|Mr+De+Haviland|Norican|Reenie+Beanie|Satisfy|Zeyada" rel="stylesheet">')
                    })
                </script>
            </section>
            <section>
                <script>
                    $(function() {
                        $(document).on('focus', 'form input', function(e) {
                            var name = $(this).attr('name')
                            $('.input-helper[data-for="' + name + '"]').fadeIn();
                        })
                    })
                </script>
                <script>
                    $(function() {
                        $('.input-help [data-toggle="tooltip"]').tooltip();
                    })
                </script>
                <script>
                    $('html, body').animate({
                        scrollTop: 0
                    }, 500);
                </script>
                <script>
                    function task() {
                        return $('#task-content').attr('data-task');
                    }

                    var Files = (function() {
                        var files = [];

                        function add(f) {
                            files.push(f);
                        }

                        function findById(id) {
                            return _.find(files, function(f) {
                                return f.id == id;
                            })
                        }

                        function findByName(name) {
                            return _.find(files, function(f) {
                                return f.name == name;
                            })
                        }

                        function findByCounter(counter) {
                            return _.find(files, function(f) {
                                return f.counter == counter;
                            })
                        }

                        function findIdByCounter(counter) {
                            var file = findByCounter(parseInt(counter));
                            return file ? file.id : undefined;
                        }

                        function naturalSorted(ids) {
                            // map ids to files
                            var selected = _.map(ids, function(id) {
                                return findById(id);
                            });

                            // natural sort by name
                            selected = selected.sort(function(a, b) {
                                return naturalSort(a.name, b.name);
                            });

                            // map back to ids
                            return _.map(selected, function(f) {
                                return f.id;
                            })
                        }

                        function debug() {
                            return _.map(files, function(f) {
                                return '[' + f.id + ',' + f.counter + ',' + f.name + ']'
                            }).join(',');
                        }

                        function duplicateFilenameExists() {
                            var filenames = _.map(files, function(f) {
                                return f.name;
                            });

                            filenames = filenames.sort();
                            for (var i = 1; i < filenames.length; i++) {
                                if (filenames[i - 1] == filenames[i]) {
                                    return true;
                                }
                            }

                            return false;
                        }

                        return {
                            add: add,
                            byId: findById,
                            byName: findByName,
                            idByCounter: findIdByCounter,
                            naturalSorted: naturalSorted,
                            debug: debug,
                            duplicateFilenameExists: duplicateFilenameExists
                        };
                    })();

                    $(function() {
                        var pro = $('body').attr('data-pro-user') == 'true';
                        var dataMultipleFiles = $('#task-content').attr('data-multiple-files')
                        var canMultiple = dataMultipleFiles == 'true' || (pro && dataMultipleFiles == 'pro')
                        var maybeMultiple = dataMultipleFiles != 'false'

                        $(document).on('fileUploadDone', function(e, data) {
                             console.log("fileUplaodDone");
                            if (data.scope != 'task-file') return;

                            var existingCount = $('.task-form').find('[name="files[]"]').length
                            if (existingCount == 1 && canMultiple == false) {
                                console.log('Rejecting multiple files, not allowed')
                                return
                            }

                            $('.task-form').append('<input type="hidden" name="files[]" value="' + data.id + '">')
                            Files.add(data);
                        })

                        $(document).on('fileUploadFailed', function(e, data) {
                            console.log("fileUploadFailed");
                            console.log("uploadfailed" + data);
                            $('[data-filename="' + encodeURIComponent(data.name) + '"]').remove()

                            // race conditions between upload and page render
                            setTimeout(function() {
                                $('[data-filename="' + encodeURIComponent(data.name) + '"]').remove()
                            }, 2000)
                        })

                        $('form.task-form').submit(function(e) {
                             console.log("task form submit ...");
                             
                            e.preventDefault();
                            var $this = $(this);

                            var $submitBtn = $this.find('[type="submit"]');
                            var task = $('#task-content').attr('data-task');

                            var allValid = runFormValidators($(document));
                            if (!allValid) {
                                showAlert('Not all input is valid', 'warning');
                                Analytics.trackEvent('taskSubmitFailed', 'Invalid inputs', task)
                                return;
                            }

                            $submitBtn.attr('disabled', 'disabled')
                            $submitBtn.prepend('<i class="fa fa-spinner fa-spin"></i>')


                            function saveByteArray(reportName, byte) {
                                var blob = new Blob([byte]);
                                var link = document.createElement('a');
                                link.href = window.URL.createObjectURL(blob);
                                var fileName = reportName + ".pdf";
                                link.download = fileName;
                                link.click();
                            };

                            function base64ToArrayBuffer(base64) {
                                var binaryString = window.atob(base64);
                                var binaryLen = binaryString.length;
                                var bytes = new Uint8Array(binaryLen);
                                for (var i = 0; i < binaryLen; i++) {
                                    var ascii = binaryString.charCodeAt(i);
                                    bytes[i] = ascii;
                                }
                                return bytes;
                            }

                            function submitTask() { //value of bounding boxes;
                                                                                         //console.log('submitTask',JSON.stringify($(this)));
                                var formData = $this.serializeJSON({
                                    parseAll: true
                                });


                               
                                console.log("submit Task", formData);
                                // getBoundary();
                                // var boundary = formData.linkOperations ? formData.linkOperations : '';
                                $.ajax('http://192.168.88.187:8080/ecvcms/f/content/pdf_edit/create_link.json', {
                                    method: 'POST',
                                    data: {
                                        src: 'https://theratechnologies.s3.amazonaws.com/dev/images/NewDocument.pdf',
                                       //14_54download.pdf
                                       // pdf: '{"boundingBoxes":[{"left":212,"top":452,"bottom":722,"right":47}],"page":"1","uri":"export.pdf"}'

                                       //16_41download.pdf
                                       //pdf: '{"boundingBoxes":[{"left":452,"top":212,"bottom":722,"right":47}],"page":"1","uri":"export.pdf"}'

                                        //18_11download.pdf
                                       // pdf: '{"boundingBoxes":[{"left":452,"top":212,"bottom":47,"right":722}],"page":"1","uri":"export.pdf"}'                  //22_23download.pdf
                                        //pdf: '{"boundingBoxes":[{"left":452,"top":722,"bottom":47,"right":212}],"page":"1","uri":"export.pdf"}'

                                        //23_55download.pdf
                                        // pdf: '{"boundingBoxes":[{"left":722,"top":452,"bottom":47,"right":212}],"page":"1","uri":"export.pdf"}'

                                        //pdf: '{"boundingBoxes":[{"left":187,"top":827,"bottom":812,"right":247}],"page":"1","uri":"export.pdf"}'
                                        pdf: formData.linkOperations[0]
                                    }

                                }).then(function(data) {
                                    console.log(data);
                                    console.log("olivier -add -log -html side --- html-html ");
                                    var link = document.createElement('a');
                                    link.href = data.dest;
                                    link.download = 'file.pdf';
                                    link.dispatchEvent(new MouseEvent('click'));

                                    // var sampleArr = base64ToArrayBuffer(data);
                                    //  console.log(data);
                                     var blob = data.dest;

                                     var data = new Blob([blob], {
                                         type: 'application/pdf'
                                     });
                                     saveAs(data, 'demo.pdf');
                                      var blob = new Blob([data], {
                                        type: "application/pdf;charset=UTF-8"
                                    });
                                    saveAs(blob, "hello world.pdf");
                                    
                                    //   saveByteArray("Sample pdf", data);
                                      var blob = new Blob([response.data], {
                                          type: 'application/pdf'
                                      });
                                      var link = document.createElement('a');
                                      link.href = window.URL.createObjectURL(blob);
                                      link.download = "SearchedResults.pdf";
                                      link.click();

                                    var file = new Blob([data], {
                                        type: 'application/pdf'
                                    });
                                    var fileURL = URL.createObjectURL(file);
                                    window.open(fileURL, "EPrescription");
                                });

                                if (typeof PdfFiles != 'undefined' && (!formData.files || !formData.files.length)) {
                                    //  showAlert('Uploads failed or no files associated with the task. Please try uploading again.')
                                    $submitBtn.removeAttr('disabled').find('.fa-spinner').remove();
                                    Analytics.trackEvent('taskSubmitFailed', 'No files', task);
                                    return;
                                }

                                formData.files = formData.files || [];

                                // we'll sort the selected files array by file name using natural sort (which ensures for example 101.pdf is before 1001.pdf)
                                formData.files = Files.naturalSorted(formData.files);

                                if (formData['type'] == 'splitByPages') {
                                    formData.step = undefined;
                                    $('.every-x-pages-selector.active').each(function() {
                                        formData.step = $('#splitStep').val()
                                    })

                                    $('.predefined-pages-selector.active').each(function(idx, elem) {
                                        formData.pages = $(this).find('input[type=radio]').val()
                                    })

                                    $('.specific-pages-selector.active').each(function() {
                                        formData.pages = $('#specificPages').val()
                                        formData.mergeResults = $('#mergeResults').is(':checked')
                                    })
                                }

                                if (formData['type'] == 'merge') {
                                    // reorder files based on user ordering
                                    formData.files = []
                                        // include specific pages
                                    formData.pages = []
                                    $('.pdf-file-item').each(function(idx, elem) {
                                        formData.files[idx] = Files.idByCounter($(this).attr('data-file-counter'));
                                        formData.pages[idx] = $(this).find('input').val()
                                    })
                                }

                                if (formData['type'] == 'alternateMix') {
                                    // reorder files based on user ordering
                                    formData.files = []
                                        // include options
                                    formData.step = []
                                    formData.reverse = []
                                    $('.pdf-file-item').each(function(idx, elem) {
                                        formData.files[idx] = Files.idByCounter($(this).attr('data-file-counter'));
                                        formData.reverse[idx] = $(this).find('.active [name="reverse"]').val()
                                        formData.step[idx] = $(this).find('[name="step[]"]').val()
                                    })

                                    if (formData.files.length < 2) {
                                        showAlert('Need at least 2 files in order to alternate & mix them.')
                                        Analytics.trackEvent('taskSubmitFailed', 'Not enough files', task)
                                        $submitBtn.removeAttr('disabled').find('.fa-spinner').remove()
                                        return
                                    }
                                }

                                if (formData['type'] == 'extractPages') {
                                    $('.predefined-pages-selector.active').each(function(idx, elem) {
                                        formData.pages = $(this).find('input[type=radio]').val()
                                    })
                                }

                                if (formData['type'] == 'combineReorder') {
                                    try {
                                        if (Files.duplicateFilenameExists()) {
                                            console.log(Files.debug());
                                            Raven.captureMessage("Duplicate filenames combine reorder");
                                        }
                                    } catch (e) {}

                                    // pages
                                    formData.filePages = []
                                    $('#pdf-canvas-list').find('.pdf-page-wrap').each(function(idx, elem) {
                                        var fileCounter = $(this).attr('data-file-counter');
                                        var filename = $(this).attr('data-filename');

                                        var fileIndex = formData.files.indexOf(Files.idByCounter(fileCounter));
                                        var page = $(elem).attr('data-page');
                                        var rotation = $(elem).find('.pdf-page').attr('data-rotation') || 0;

                                        if (filename == 'blank_page') {
                                            formData.filePages[idx] = '-1:-1:' + rotation;
                                        } else if (fileIndex >= 0 && typeof page != 'undefined') {
                                            formData.filePages[idx] = fileIndex + ':' + page + ':' + rotation
                                        } else {
                                            // this should not happen. troubleshoot
                                            formData.filePages[idx] = '??' + filename + ':' + page + ':' + rotation + ':' + Files.debug()
                                            Raven.captureMessage("Invalid files combine reorder");
                                        }
                                    })
                                }

                                if (formData['type'] == 'splitByBookmarks') {
                                    $('#bookmarksLevelSelector').find('.active input').each(function(idx, elem) {
                                        formData.bookmarksLevel = $(elem).val()
                                    })

                                    if (!formData.bookmarksLevel) {
                                        showAlert('No bookmarks level selected.', 'warning');
                                        $submitBtn.removeAttr('disabled').find('.fa-spinner').remove();
                                        return;
                                    }
                                }

                                if (formData['type'] == 'splitByText') {
                                    if (formData.area.x == "") {
                                        showAlert('Please select the page area based on which to split.', 'warning')
                                        $submitBtn.removeAttr('disabled').find('.fa-spinner').remove()
                                        return
                                    }
                                }

                                if (formData['type'] == 'rotatePages') {
                                    var $predefined = $('.predefined-pages-selector.active')
                                    if ($predefined.length > 0) {
                                        $predefined.each(function(i, elem) {
                                            formData.pages = $(elem).find('input').val()
                                        })
                                    } else {
                                        formData.pages = []
                                        formData.rotations = []
                                        $('.pdf-page[data-rotation]').each(function(i, elem) {
                                            formData.pages[i] = $(elem).parents('.pdf-page-wrap').attr('data-page')
                                            formData.rotations[i] = $(elem).attr('data-rotation')
                                        })

                                        formData.pages = formData.pages.join(',')
                                        formData.rotations = formData.rotations.join(',')

                                        if (formData.pages.trim() == '') {
                                            showAlert('Please select pages to rotate')
                                            Analytics.trackEvent('taskSubmitFailed', 'No pages rotated', task)
                                            $submitBtn.removeAttr('disabled').find('.fa-spinner').remove()
                                            return;
                                        }
                                    }
                                }

                                if (formData['type'] == 'crop') {
                                    if (formData['area']['bottom'] === '') {
                                        showAlert('Please select area to crop.')
                                        $submitBtn.removeAttr('disabled').find('.fa-spinner').remove()
                                        return;
                                    }
                                }

                                if (formData['type'] == 'edit') {
                                    _.each(['appendTextOperations', 'editTextOperations', 'imageOperations', 'shapeOperations',
                                        'insertPageOperations', 'deletePageOperations', 'highlightTextOperations',
                                        'strikethroughTextOperations', 'linkOperations', 'formValues'
                                    ], function(fieldName) {
                                        formData[fieldName] = _.map(formData[fieldName], function(str) {
                                            return JSON.parse(str);
                                        })
                                    });
                                    formData['formValues'] = formData['formValues'][0];
                                }

                                if (formData['type'] == 'watermark') {
                                    var json = JSON.parse(formData['jsonData']);
                                    delete formData['jsonData']
                                    _.extend(formData, json);
                                }

                                if (formData['type'] == 'pdfToExcel') {
                                    _.each(['tables'], function(fieldName) {
                                        formData[fieldName] = _.map(formData[fieldName], function(str) {
                                            return JSON.parse(str)
                                        })
                                    })
                                }

                                formData['userAgent'] = navigator.userAgent;

                                //          var debug = JSON.parse('')
                                //          debug.files = formData.files
                                //          formData = debug

                                if (window.location.hostname.indexOf('local') >= 0) {
                                    console.log(JSON.stringify(formData, null, 2));
                                }                                                                  console.log('before jsonPost');
/*
                                $.jsonPost('/api/tasks', formData)
                                    .done(function(data) {
                                        Analytics.trackEvent('task', formData['type'])
                                        var url = "result?id=" + encodeURIComponent(data)

                                        var partnerKey = getQueryParameterByName("partnerKey")
                                        if (partnerKey) {
                                            url += "&partnerKey=" + encodeURIComponent(partnerKey)
                                        }

                                        if ($('body').width() > 500) {
                                            showResultsModal(url)
                                        } else {
                                            window.location.href = url
                                        }

                                        $(document).trigger('taskSubmitDone');
                                    })
                                    .fail(function(jqXHR, textStatus, errorThrown) {
                                        if (jqXHR.status == 402) {
                                            showUpgradePopup('tasks-per-hour')
                                            Analytics.trackEvent('paywall', 'tasks-per-hour', task)
                                            $('.top-alert.alert-info').remove()
                                            $submitBtn.find('.fa-spinner').remove()
                                            return
                                        } else if (jqXHR.status == 429) {
                                            showAlert('Too many requests. Wait for few minutes, then try again.')
                                            Analytics.trackEvent('taskSubmitFailed', 'Slow down', task)
                                        } else {
                                            showAlert('Something went wrong. That\'s all we know. Check parameters and try again.')
                                            Analytics.trackEvent('taskSubmitFailed', 'Server rejected', task)
                                        }
                                    })
                                    .always(function() {
                                        $submitBtn.removeAttr('disabled').find('.fa-spinner').remove()
                                    });*/
                            }

                            function submitTaskWhenAllFilesFinishedUploading() {
                                setTimeout(function() {                                             //console.log('PdfFiles', PdfFiles);
                                    if (typeof PdfFiles != 'undefined' && PdfFiles.filesUploading > 0) {
                                        submitTaskWhenAllFilesFinishedUploading();
                                    } else {
                                        $('.top-alert.alert-info').hide();                    
                                        submitTask();
                                    }
                                }, 1000);
                            }

                            if (typeof PdfFiles != 'undefined' && PdfFiles.filesUploading > 0) {
                                showAlert('Files are still uploading, please wait...', 'info', false)
                            }

                            submitTaskWhenAllFilesFinishedUploading();

                        });

                        var outputFilenamePatterns = ['CURRENTPAGE]', 'BASENAME]', 'TIMESTAMP]', 'FILENUMBER]', 'BOOKMARK_NAME]', 'BOOKMARK_NAME_STRICT]', 'TEXT]'];
                        $(document).find('input[name="outputFilenamePattern"]').mention({
                            emptyQuery: true,
                            delimiter: '[',
                            users: _.map(outputFilenamePatterns, function(p) {
                                return {
                                    username: p
                                }
                            })
                        });
                    });
                </script>
                <div id="taskResultsModal" role="dialog" tabindex="-1" class="modal fade">
                </div>
                <script>
                    $(function() {
                        var $modal = $('#taskResultsModal');
                        window.showResultsModal = function(url) {
                            $modal.find('iframe').remove()
                            $modal.append('<iframe src="' + url + '" id="taskResultsFrame" name="_results"></iframe>')
                            $modal.modal('show');
                        }
                        window.closeResultsFrame = function() {
                            $modal.modal('hide');
                        }
                    })
                </script>
            </section>
            <div style="margin-top: 60px;" class="container centered step1">
                <div class="row">
                    <a href="javascript://" target="_blank" class="btn contact-btn btn-light btn-xs get-support-btn">Contact Support</a>
                </div>
            </div>
          
          
          
        </section>
  <!--  </div>-->
   <!--
    <div class="right_pane" style="float:left ; width:50% ;  border: 1px solid blue;">
        <label style: "text-align:center;"> Second PDF</label>
        <canvas id="the-canvas" style="width:100%"></canvas>


    </div>
    <div style="clear: both;"></div>  -->
    <script>
        WebFont.load({
            google: {
                families: ['Montserrat:200,400,700:latin']
            }
        });
    </script>
    <script src="https://use.fontawesome.com/572e7c8d9e.js" async="async"></script>
    <script>
        $(window).load(function() {
            $('body').append('<script type="text/javascript" async="async" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="23zboc4jkervzht"></s' + 'cript>')
        })
    </script>
    <script>
        $(window).load(function() {
            $('img.deferred[data-src]').each(function() {
                var src = $(this).attr('data-src');
                $(this).attr('src', src);
            })
        });
    </script>
    <script type="text/javascript">
        // <![CDATA[

        var lift_page = "F558528478443QPDK4K";
        // ]]>
    </script>
</body>

</html>
